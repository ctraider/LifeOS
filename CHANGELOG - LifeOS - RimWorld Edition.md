# CHANGELOG - LifeOS - RimWorld Edition

## [Версия 2.0 - Интеграция и Улучшения] - 2025-05-14

Это обновление основано на обратной связи пользователя и направлено на значительное улучшение функциональности и удобства использования LifeOS - RimWorld Edition. Ключевые изменения включают интеграцию расширенного планировщика, полностью редактируемый профиль персонажа, интерактивный инвентарь с drag-and-drop и сохранение всех данных в localStorage.

### Ключевые Изменения:

-   **Интеграция Планировщика (`plan.html`):
    -   Содержимое и функционал `plan.html` были полностью интегрированы во новую вкладку "Планировщик" в основном файле `index.html`.
    -   Сохранены все ключевые функции планировщика: создание задач (с важностью, срочностью, приоритетом, дедлайном), управление подзадачами, календарь, матрица Эйзенхауэра, система геймификации (уровни, опыт, валюта, здоровье), банк виртуальной валюты, отслеживание прогресса по сбережениям и система достижений.
    -   Все ID элементов и вызовы функций в планировщике были адаптированы (с суффиксом `-planner`) для избежания конфликтов с основным приложением.
    -   Стили планировщика были частично адаптированы для лучшего соответствия общему стилю RimWorld Edition.
    -   Все данные планировщика теперь сохраняются в `localStorage`.

-   **Редактируемый Профиль Персонажа (Вкладка "Персона")**:
    -   Пользователь теперь может самостоятельно вводить и изменять: Имя персонажа, Возраст, Предысторию, Черты характера, Навыки (с указанием уровня/максимума) и Экипировку.
    -   Реализована функция загрузки аватара пользователя (сохраняется как Base64 строка).
    -   Все данные профиля персонажа сохраняются в `localStorage` при нажатии кнопки "Сохранить Персону" и автоматически загружаются при открытии приложения.

-   **Интерактивный Инвентарь (Вкладка "Вещи")**:
    -   Полностью переработан инвентарь для поддержки интерактивного взаимодействия.
    -   Реализована функция **drag-and-drop** для перемещения предметов между ячейками инвентаря.
    -   Добавлена возможность **добавления новых предметов** с указанием названия, количества и типа (оружие, одежда, ресурсы, медикаменты).
    -   Реализовано **контекстное меню** (по правому клику на предмет) для удаления или переименования предмета.
    -   Сохранена и адаптирована **фильтрация предметов** по типу.
    -   Состояние инвентаря (все предметы, их количество, типы и расположение в ячейках) сохраняется в `localStorage`.
    -   Максимальное количество ячеек инвентаря ограничено (например, 20 слотов).

-   **Структура Проекта и JavaScript:**
    -   Вся JavaScript-логика вынесена в отдельный файл `script.js` для лучшей организации кода.
    -   Реализованы функции для сохранения и загрузки всех пользовательских данных (профиль, инвентарь, планировщик) из `localStorage`.
    -   Улучшена общая структура HTML и JS для поддержки новых функций.

-   **Обновление Документации:**
    -   `README.md`: Полностью переписан для отражения новой версии, включая описание интегрированного планировщика, редактируемого профиля, интерактивного инвентаря и инструкций по работе с локальным сохранением.
    -   `PROJECT_STRUCTURE.md`: Обновлен для детального описания новой файловой структуры (`index.html`, `script.js`), структуры DOM и ключевых компонентов JavaScript.
    -   `CHANGELOG.md` (данный файл): Обновлен для документирования всех изменений в этой версии.

-   **Сохранение Старого Функционала (где применимо):**
    -   Базовая структура вкладок и их назначение сохранены, но многие из них (`Потребности`, `Здоровье` и т.д.) все еще являются заглушками и требуют дальнейшей реализации специфической логики.
    -   Система XP и уровней в шапке сайта пока не связана с геймификацией планировщика или другими действиями пользователя и требует доработки.

### Предыдущие версии:

-   **[Версия RimWorld Edition] - 2025-05-14 (Первоначальная трансформация)**
    -   Полный редизайн UI/UX в стиле RimWorld.
    -   Изменение структуры вкладок.
    -   Базовое наполнение контентом и структурой модулей.
    -   Обновление документации (`README.md`, `PROJECT_STRUCTURE.md`).

## [Исходная Версия LifeOS] - (Дата до 2025-05-14)

-   Приложение с вкладками: Задачи, Здоровье, Отношения, Навыки, Инвентарь.
-   Система XP и уровней.
-   Локальное хранение данных.
-   Темная/Светлая тема.
-   Интеграция с `plan.html` (как отдельный файл).

## [Версия 2.0.1 - Исправления и Повышение Надёжности] - 2025-05-15

### Исправления и улучшения:

- Исправлена критическая ошибка `Uncaught TypeError: Cannot read properties of null (reading 'addEventListener')`:
    - Для всех элементов, к которым добавляются обработчики событий через JS, теперь предварительно проверяется их существование в DOM.
    - Это предотвращает падение скрипта при отсутствии элементов (например, кнопок модального окна планировщика).

- Все inline-обработчики событий (onclick) в HTML теперь используют глобальные функции через `window.functionName()`:
    - Это гарантирует корректную работу всех кнопок и элементов управления, даже если функции определены во внешнем файле script.js.
    - Исправлены все соответствующие вызовы для вкладок "Персона", "Здоровье", "Социум", "Работа", "Вещи", "Планировщик" и др.

- Добавлены проверки на существование DOM-элементов перед работой с ними в JS:
    - Для всех элементов, получаемых через `getElementById`, добавлены проверки перед добавлением обработчиков событий или манипуляциями с DOM.
    - Это повысило устойчивость приложения к изменению структуры HTML.

- Исправлены инициализации и вызовы функций:
    - Удалены дублирующиеся или конфликтующие вызовы функций.
    - Все функции, используемые в HTML через onclick, экспортированы в глобальную область видимости (`window.functionName = functionName`).

- Улучшена структура и устойчивость кода:
    - Код стал более защищённым от ошибок, связанных с отсутствием элементов или неправильным порядком загрузки скриптов.
    - Приложение теперь работает без ошибок в консоли, связанных с обработчиками событий и глобальными функциями.

- Обновлена документация:
    - Данный CHANGELOG дополнен описанием всех исправлений и улучшений за сессию 2025-05-15.
