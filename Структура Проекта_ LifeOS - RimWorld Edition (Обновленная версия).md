# Структура Проекта: LifeOS - RimWorld Edition (Обновленная версия)

## Обзор

Проект LifeOS - RimWorld Edition представляет собой одностраничное веб-приложение (`index.html`), которое динамически управляется с помощью JavaScript (`script.js`). Стилизация выполнена в духе игры RimWorld и содержится внутри тегов `<style>` в `index.html`.

## Файловая Структура

-   `/` (корневая директория проекта)
    -   `index.html`: Основной и единственный HTML-файл. Содержит всю разметку для всех вкладок, включая интегрированный планировщик.
    -   `script.js`: JavaScript-файл, содержащий всю логику приложения:
        -   Управление вкладками.
        -   Функции для сохранения и загрузки данных профиля персонажа (имя, возраст, предыстория, черты, навыки, экипировка, аватар) в `localStorage`.
        -   Реализация интерактивного инвентаря (добавление, удаление, переименование предметов, drag-and-drop, фильтрация, сохранение/загрузка в `localStorage`).
        -   Полная логика интегрированного планировщика задач (из `plan.html`), включая управление задачами, подзадачами, календарь, матрицу Эйзенхауэра, геймификацию (XP, уровни, валюта, HP), банк валют, прогресс сбережений, достижения. Все данные планировщика также сохраняются в `localStorage`.
        -   Общие вспомогательные функции.
    -   `README.md`: Описание проекта, его возможностей и инструкций по запуску (обновлено).
    -   `PROJECT_STRUCTURE.md`: Данный файл, описывающий структуру проекта (обновлено).
    -   `CHANGELOG.md`: История изменений проекта (будет обновлен).
    -   `TZ.txt`: Оригинальное техническое задание от пользователя.
    -   `currency-logo.png` (опционально): Изображение для банка валют в планировщике. Если отсутствует, будет отображаться CSS-заглушка.

## Ключевые Компоненты в `index.html`

-   **Header:** Содержит заголовок, информацию об уровне и опыте (пока статично, требует привязки к логике геймификации планировщика или общей системы), и кнопку переключения темы (функционал не реализован в текущей версии, оставлен как заглушка).
-   **Tabs (`<div class="tabs">`):** Навигационная панель для переключения между основными разделами приложения.
    -   Каждая вкладка (`<div class="tab">`) вызывает функцию `openTab(event, 'tabName')`.
-   **Content Sections (`<div class="content" id="tabName">`):** Контейнеры для содержимого каждой вкладки. Активная вкладка имеет класс `active`.
    -   `id="summary"`: Вкладка "Обзор".
    -   `id="persona"`: Вкладка "Персона". Содержит `input` и `textarea` для редактирования данных персонажа, кнопку для загрузки аватара и кнопку "Сохранить Персону".
    -   `id="needs"`: Вкладка "Потребности".
    -   `id="health_detailed"`: Вкладка "Здоровье".
    -   `id="social"`: Вкладка "Социум".
    -   `id="work"`: Вкладка "Работа".
    -   `id="items"`: Вкладка "Вещи" (Инвентарь). Содержит кнопки для добавления и сохранения инвентаря, фильтры и контейнер `inventoryGridContainer` для ячеек инвентаря, управляемых через `script.js`.
    -   `id="journal"`: Вкладка "Журнал".
    -   `id="procedures_history"`: Вкладка "Процедуры/История".
    -   `id="planner"`: Вкладка "Планировщик". Содержит всю HTML-структуру, перенесенную из `plan.html` и адаптированную для интеграции (изменены ID элементов для избежания конфликтов, например, `new-task-planner`).

## Ключевые Компоненты в `script.js`

-   **`savePersonaData()` / `loadPersonaData()`:** Функции для сохранения и загрузки данных профиля персонажа из `localStorage`.
-   **Логика Аватара:** Загрузка изображения, конвертация в Base64 и сохранение в `localStorage` вместе с остальными данными персоны.
-   **Логика Инвентаря (`inventoryItems`, `renderInventory()`, `handleDragStart()`, etc.):** Управление массивом предметов, рендеринг ячеек, реализация drag-and-drop, добавление/удаление/редактирование предметов, фильтрация, сохранение/загрузка из `localStorage`.
-   **Логика Планировщика (перенесенная и адаптированная из `plan.html`):**
    -   Управление задачами (`tasksPlanner`, `addTaskPlanner()`, `renderTasksPlanner()`, `saveTasksPlanner()`, `loadTasksPlanner()`).
    -   Управление календарем (`renderCalendarPlanner()`, `prevMonthPlanner()`, `nextMonthPlanner()`).
    -   Управление банком валют (`convertCurrencyPlanner()`, `updateCurrencyDisplayPlanner()`).
    -   Управление достижениями (`addAchievementPlanner()`, `renderAchievementsPlanner()`).
    -   Геймификация (обновление XP, уровня, HP - требует более глубокой интеграции с основным приложением).
    -   Все ID элементов и вызовы функций в этой секции адаптированы с суффиксом `-planner` для избежания конфликтов.
-   **`openTab(evt, tabName)`:** Глобальная функция для переключения между вкладками.
-   **`DOMContentLoaded` Listener:** Инициализация загрузки данных (персона, инвентарь, планировщик) при старте приложения.

## Стилизация

-   Все CSS-стили находятся внутри тега `<style>` в `index.html`.
-   Основные стили вдохновлены RimWorld.
-   Стили, специфичные для планировщика (из `plan.html`), были частично адаптированы для лучшей интеграции, но могут требовать дальнейшей доработки для полного соответствия стилю RimWorld Edition.
-   Подключены внешние шрифты (Roboto) и иконки (Font Awesome) через CDN, как это было в `plan.html`.

## Локальное Хранение (`localStorage`)

-   `personaData`: JSON-строка с данными профиля персонажа.
-   `personaAvatar`: Base64-строка изображения аватара.
-   `rimworldInventory`: JSON-строка с массивом предметов инвентаря.
-   `rimworldPlannerTasks`: JSON-строка с задачами планировщика.
-   `rimworldPlannerCurrency`: Данные о валюте планировщика.
-   `rimworldPlannerSavingsGoal`, `rimworldPlannerSavedAmount`: Данные о целях сбережений.
-   `rimworldPlannerAchievements`: Список достижений планировщика.
-   `rimworldPlannerXP`, `rimworldPlannerLevel`, `rimworldPlannerHP`: Параметры геймификации планировщика.

Эта структура обеспечивает модульность в рамках одного HTML-файла и разделение логики в `script.js`, что упрощает дальнейшую разработку и поддержку.
