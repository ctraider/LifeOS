<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeOS - RimWorld Edition</title>
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <!-- Chart.js –¥–ª—è –ª–µ–ø–µ—Å—Ç–∫–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>LifeOS</h1>
        <div class="level">–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span> | –û–ø—ã—Ç: <span id="xp">0</span>/100</div>
        <div class="xp-container">
            <div class="xp-bar-wrapper">
                <div class="xp-bar" id="xpBar">
                    <div class="xp-progress" id="xpProgress"></div>
                    <div class="xp-segments" id="xpSegments"></div>
                    <div class="xp-glow"></div>
                </div>
                <div class="xp-tooltip" id="xpTooltip">
                    <div class="tooltip-content">
                        <h4>–°–∏—Å—Ç–µ–º–∞ –æ–ø—ã—Ç–∞</h4>
                        <p><strong>–ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞:</strong> +50 XP</p>
                        <p><strong>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞:</strong> +75 XP</p>
                        <p><strong>–ë–æ—Å—Å-–∑–∞–¥–∞—á–∞:</strong> +100 XP</p>
                        <p><strong>–ü–æ–¥–∑–∞–¥–∞—á–∞:</strong> +25 XP</p>
                        <hr>
                        <p><strong>–¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:</strong> <span id="tooltipCurrentXP">0</span>/<span id="tooltipRequiredXP">100</span> XP</p>
                        <p><strong>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è:</strong> <span id="tooltipRemainingXP">100</span> XP</p>
                    </div>
                </div>
            </div>
        </div>
        <button id="themeToggle" style="position:absolute;top:1rem;right:1rem;">üåô</button>
    </header>

    <div class="tabs">
        <div class="tab active" onclick="openTab(event, 'summary')">–û–±–∑–æ—Ä</div>
        <div class="tab" onclick="openTab(event, 'persona')">–ü–µ—Ä—Å–æ–Ω–∞</div>
        <div class="tab" onclick="openTab(event, 'needs')">–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏</div>
        <div class="tab" onclick="openTab(event, 'health_detailed')">–ó–¥–æ—Ä–æ–≤—å–µ</div>
        <div class="tab" onclick="openTab(event, 'social')">–°–æ—Ü–∏—É–º</div>
        <div class="tab" onclick="openTab(event, 'work')">–†–∞–±–æ—Ç–∞</div>
        <div class="tab" onclick="openTab(event, 'items')">–í–µ—â–∏</div>
        <div class="tab" onclick="openTab(event, 'journal')">–ñ—É—Ä–Ω–∞–ª</div>
        <div class="tab" onclick="openTab(event, 'procedures_history')">–ü—Ä–æ—Ü–µ–¥—É—Ä—ã/–ò—Å—Ç–æ—Ä–∏—è</div>
        <div class="tab" onclick="openTab(event, 'planner')">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</div>
    </div>

    <!-- –û–±–∑–æ—Ä -->
    <div id="summary" class="content active">
        <!-- RPG-—Å—Ç–∏–ª—å –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ -->
        <div class="rpg-overview-container">
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –ê–≤–∞—Ç–∞—Ä –∏ –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="rpg-character-panel">
                <div class="rpg-avatar-section">
                    <div class="rpg-avatar-frame">
                        <div class="rpg-avatar" id="rpgAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="rpg-level-badge">
                            <span id="rpgLevel">1</span>
                        </div>
                    </div>
                    <div class="rpg-character-info">
                        <h2 class="rpg-character-name" id="rpgCharacterName">–ü–µ—Ä—Å–æ–Ω–∞–∂</h2>
                        <div class="rpg-class-title">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –ü—É—Å—Ç–æ—à–µ–π</div>
                    </div>
                </div>

                <!-- XP –∏ —É—Ä–æ–≤–µ–Ω—å -->
                <div class="rpg-xp-section">
                    <div class="rpg-xp-label">–û–ø—ã—Ç</div>
                    <div class="rpg-xp-bar">
                        <div class="rpg-xp-fill" id="rpgXpFill"></div>
                        <div class="rpg-xp-text" id="rpgXpText">0 / 100</div>
                    </div>
                </div>

                <!-- –ë—ã—Å—Ç—Ä—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
                <div class="rpg-quick-stats">
                    <div class="rpg-stat-item">
                        <i class="fas fa-heart"></i>
                        <span class="rpg-stat-label">–ó–¥–æ—Ä–æ–≤—å–µ</span>
                        <span class="rpg-stat-value" id="rpgHealth">100</span>
                    </div>
                    <div class="rpg-stat-item">
                        <i class="fas fa-coins"></i>
                        <span class="rpg-stat-label">–í–∞–ª—é—Ç–∞</span>
                        <span class="rpg-stat-value" id="rpgCurrency">0</span>
                    </div>
                    <div class="rpg-stat-item">
                        <i class="fas fa-tasks"></i>
                        <span class="rpg-stat-label">–ó–∞–¥–∞—á–∏</span>
                        <span class="rpg-stat-value" id="rpgTasksCount">0/0</span>
                    </div>
                </div>
            </div>

            <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∑–∞–¥–∞—á–∏ -->
            <div class="rpg-main-panel">
                <!-- –°—Ç–∞—Ç—É—Å-–±–∞—Ä—ã –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π -->
                <div class="rpg-status-section">
                    <h3 class="rpg-section-title"><i class="fas fa-tachometer-alt"></i> –°–æ—Å—Ç–æ—è–Ω–∏–µ</h3>
                    <div class="rpg-status-bars">
                        <div class="rpg-status-bar">
                            <div class="rpg-status-label">–ì–æ–ª–æ–¥</div>
                            <div class="rpg-progress-bar hunger">
                                <div class="rpg-progress-fill" id="rpgHunger" data-value="70"></div>
                            </div>
                            <span class="rpg-status-value">70%</span>
                        </div>
                        <div class="rpg-status-bar">
                            <div class="rpg-status-label">–û—Ç–¥—ã—Ö</div>
                            <div class="rpg-progress-bar rest">
                                <div class="rpg-progress-fill" id="rpgRest" data-value="80"></div>
                            </div>
                            <span class="rpg-status-value">80%</span>
                        </div>
                        <div class="rpg-status-bar">
                            <div class="rpg-status-label">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ</div>
                            <div class="rpg-progress-bar recreation">
                                <div class="rpg-progress-fill" id="rpgRecreation" data-value="60"></div>
                            </div>
                            <span class="rpg-status-value">60%</span>
                        </div>
                        <div class="rpg-status-bar">
                            <div class="rpg-status-label">–ö–æ–º—Ñ–æ—Ä—Ç</div>
                            <div class="rpg-progress-bar comfort">
                                <div class="rpg-progress-fill" id="rpgComfort" data-value="75"></div>
                            </div>
                            <span class="rpg-status-value">75%</span>
                        </div>
                    </div>
                </div>

                <!-- –¢–µ–∫—É—â–∞—è –º–∏—Å—Å–∏—è/–∑–∞–¥–∞—á–∞ -->
                <div class="rpg-mission-section">
                    <h3 class="rpg-section-title"><i class="fas fa-crosshairs"></i> –¢–µ–∫—É—â–∞—è –ú–∏—Å—Å–∏—è</h3>
                    <div class="rpg-mission-card" id="rpgCurrentMission">
                        <div class="rpg-mission-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div class="rpg-mission-progress">
                            <div class="rpg-mission-bar">
                                <div class="rpg-mission-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                <div class="rpg-notifications">
                    <h3 class="rpg-section-title"><i class="fas fa-exclamation-triangle"></i> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                    <div class="rpg-notification-list" id="rpgNotifications">
                        <div class="rpg-notification-item info">
                            <i class="fas fa-info-circle"></i>
                            <span>–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            <div class="rpg-side-panel">
                <!-- –ë—ã—Å—Ç—Ä—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
                <div class="rpg-inventory-section">
                    <h3 class="rpg-section-title"><i class="fas fa-backpack"></i> –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
                    <div class="rpg-quick-inventory" id="rpgQuickInventory">
                        <!-- –ü–µ—Ä–≤—ã–µ 6 —Å–ª–æ—Ç–æ–≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
                    </div>
                    <button class="rpg-btn rpg-btn-small" onclick="openTab(event, 'items')">–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
                </div>

                <!-- –ù–µ–¥–∞–≤–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
                <div class="rpg-achievements-section">
                    <h3 class="rpg-section-title"><i class="fas fa-trophy"></i> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                    <div class="rpg-recent-achievements" id="rpgRecentAchievements">
                        <div class="rpg-achievement-item">
                            <i class="fas fa-star"></i>
                            <span>–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏</span>
                        </div>
                    </div>
                    <button class="rpg-btn rpg-btn-small" onclick="openTab(event, 'planner')">–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
                </div>

                <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                <div class="rpg-quick-actions">
                    <h3 class="rpg-section-title"><i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="rpg-action-buttons">
                        <button class="rpg-btn" onclick="openTab(event, 'planner')">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
                        </button>
                        <button class="rpg-btn" onclick="openHealthLogModal()">
                            <i class="fas fa-heart-pulse"></i> –ó–∞–ø–∏—Å–∞—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
                        </button>
                        <button class="rpg-btn" onclick="openTab(event, 'items')">
                            <i class="fas fa-cube"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—â–∞–º–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–µ—Ä—Å–æ–Ω–∞ -->
    <div id="persona" class="content">
        <h2>–ü–µ—Ä—Å–æ–Ω–∞: <input type="text" id="personaNameInput" placeholder="–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞" style="width: 200px;"> <button onclick="window.savePersonaData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ü–µ—Ä—Å–æ–Ω—É</button></h2>
        <div class="persona-section" style="display: flex; gap: 2rem;">
            <div class="persona-avatar" style="width: 150px; height: 150px; background: #4A4A4A; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #888; border: 1px solid #2A2A2A;">
                –ê–≤–∞—Ç–∞—Ä
                 <input type="file" id="avatarUpload" accept="image/*" style="display:none;">
                 <button onclick="document.getElementById('avatarUpload').click();" style="font-size:0.8em; padding: 0.2em 0.4em; margin-top:5px;">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            </div>
            <div class="persona-info" style="flex: 1;">
                <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> <input type="number" id="personaAgeInput" placeholder="–í–æ–∑—Ä–∞—Å—Ç" style="width: 60px;" value="28"> –ª–µ—Ç</p>
                <p><strong>–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:</strong></p>
                <textarea id="personaBackstoryInput" placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—é" style="width: 95%; min-height: 60px;">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –ø—É—Å—Ç–æ—à–µ–π</textarea>
                <p style="margin-top:0.5rem;"><strong>–ß–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞:</strong></p>
                <textarea id="personaTraitsInput" placeholder="–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é" style="width: 95%; min-height: 40px;">–¢—Ä—É–¥–æ–ª—é–±–∏–≤—ã–π, –û–ø—Ç–∏–º–∏—Å—Ç, –ù–µ—Ä–≤–Ω—ã–π</textarea>
                <p style="margin-top:0.5rem;"><strong>–ù–∞–≤—ã–∫–∏ (—Ñ–æ—Ä–º–∞—Ç: –ù–∞–≤—ã–∫: –£—Ä–æ–≤–µ–Ω—å/–ú–∞–∫—Å):</strong></p>
                <textarea id="personaSkillsInput" placeholder="–ü—Ä–∏–º–µ—Ä: –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ: 8/20, –ú–µ–¥–∏—Ü–∏–Ω–∞: 5/20" style="width: 95%; min-height: 60px;">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ: 8/20
–ú–µ–¥–∏—Ü–∏–Ω–∞: 5/20
–°—Ç—Ä–µ–ª—å–±–∞: 12/20</textarea>
            </div>
        </div>
        <div class="persona-section" style="margin-top: 1rem;">
            <h3>–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞</h3>
            <textarea id="personaEquipmentInput" placeholder="–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ —ç–∫–∏–ø–∏—Ä–æ–≤–∫—É, –∫–∞–∂–¥—ã–π –ø—Ä–µ–¥–º–µ—Ç —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏" style="width: 95%; min-height: 80px;">–û–¥–µ–∂–¥–∞: –ü—ã–ª—å–Ω–∏–∫
–û—Ä—É–∂–∏–µ: –õ–∞–∑–µ—Ä–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç</textarea>
        </div>
    </div>

    <!-- –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ -->
    <div id="needs" class="content">
        <h2>–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏</h2>
        <div class="needs-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–ì–æ–ª–æ–¥</h3>
                <progress id="needHunger" value="70" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="hungerStatus">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω</span></p>
                    </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–û—Ç–¥—ã—Ö</h3>
                <progress id="needRest" value="80" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="restStatus">–û—Ç–¥–æ—Ö–Ω—É–≤—à–∏–π</span></p>
                </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ</h3>
                <progress id="needRecreation" value="60" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="recreationStatus">–ù—É–∂–¥–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è—Ö</span></p>
                    </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–ö—Ä–∞—Å–æ—Ç–∞</h3>
                <progress id="needBeauty" value="50" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="beautyStatus">–†–∞–≤–Ω–æ–¥—É—à–µ–Ω</span></p>
                </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–ö–æ–º—Ñ–æ—Ä—Ç</h3>
                <progress id="needComfort" value="75" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="comfortStatus">–ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ</span></p>
                    </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ</h3>
                <progress id="needSpace" value="90" max="100" style="width: 100%;"></progress>
                <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: <span id="spaceStatus">–ü—Ä–æ—Å—Ç–æ—Ä–Ω–æ</span></p>
                </div>
            </div>
        </div>

    <!-- –ó–¥–æ—Ä–æ–≤—å–µ (–î–µ—Ç–∞–ª—å–Ω–æ) -->
    <div id="health_detailed" class="content">
        <h2>–ó–¥–æ—Ä–æ–≤—å–µ: <span id="healthCharacterName">–ò–º—è—Ä–µ–∫</span></h2>
        <div class="health-overview" style="margin-bottom: 1rem; padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <p><strong>–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</strong> <span id="generalHealthStatus" style="color: green;">–í –ø–æ—Ä—è–¥–∫–µ</span></p>
            <p><strong>–¢—Ä–∞–≤–º—ã:</strong> <span id="injuriesCount">0</span></p>
            <p><strong>–ë–æ–ª–µ–∑–Ω–∏:</strong> <span id="illnessesCount">0</span></p>
            <button onclick="window.openHealthLogModal()" style="margin-top: 0.5rem;">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –æ –∑–¥–æ—Ä–æ–≤—å–µ</button>
                    </div>

        <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è RPG —Å—Ç–∞—Ç–æ–≤ –∑–¥–æ—Ä–æ–≤—å—è -->
        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è</h3>
            <button onclick="window.openAddHealthStatModal()" style="margin-bottom: 1rem;">–î–æ–±–∞–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É</button>
            <div id="health-stats-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ script.js (renderHealthStats) -->
                </div>
                    </div>

        <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–µ–π –∂—É—Ä–Ω–∞–ª–∞ –∑–¥–æ—Ä–æ–≤—å—è -->
        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>–ñ—É—Ä–Ω–∞–ª –∑–¥–æ—Ä–æ–≤—å—è</h3>
            <div id="healthList" style="display: flex; flex-direction: column; gap: 0.5rem;">
                <!-- –ó–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ script.js (renderHealth) -->
                </div>
                    </div>

        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>–ß–∞—Å—Ç–∏ –¢–µ–ª–∞</h3>
            <ul id="bodyPartsList" style="list-style: none; padding-left: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–ì–æ–ª–æ–≤–∞: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–¢—É–ª–æ–≤–∏—â–µ: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–õ–µ–≤–∞—è —Ä—É–∫–∞: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–ü—Ä–∞–≤–∞—è —Ä—É–∫–∞: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–õ–µ–≤–∞—è –Ω–æ–≥–∞: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">–ü—Ä–∞–≤–∞—è –Ω–æ–≥–∞: <span style="color: green;">100%</span></li>
            </ul>
                </div>

        <div class="health-section">
            <h3>–û–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ü—Ä–æ—Ü–µ–¥—É—Ä—ã</h3>
            <button onclick="window.openScheduleOperationModal()" style="margin-bottom: 0.5rem;">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</button>
            <ul id="medicalOperationsList" style="list-style: none; padding-left: 0;">
                <li>–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.</li>
            </ul>
        </div>
    </div>

    <!-- –°–æ—Ü–∏—É–º -->
    <div id="social" class="content">
        <h2>–°–æ—Ü–∏—É–º</h2>
        <div class="social-filters" style="margin-bottom: 1rem;">
            <button onclick="window.filterSocial('all')">–í—Å–µ</button>
            <button onclick="window.filterSocial('friends')">–î—Ä—É–∑—å—è</button>
            <button onclick="window.filterSocial('family')">–°–µ–º—å—è</button>
            <button onclick="window.filterSocial('colleagues')">–ö–æ–ª–ª–µ–≥–∏</button>
            <button onclick="window.filterSocial('enemies')">–í—Ä–∞–≥–∏</button>
                    </div>
        <div id="socialListContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <!-- –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ -->
            <div class="social-entry" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <p><strong>–ò–º—è:</strong> –ï–ª–µ–Ω–∞ <span style="color: blue;">(–î—Ä—É–≥)</span></p>
                <p><strong>–û—Ç–Ω–æ—à–µ–Ω–∏–µ:</strong> +75</p>
                <p><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç:</strong> 2 –¥–Ω—è –Ω–∞–∑–∞–¥</p>
                <button onclick="window.interactSocial('Elena')">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                </div>
            <div class="social-entry" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <p><strong>–ò–º—è:</strong> –í–∏–∫—Ç–æ—Ä <span style="color: red;">(–í—Ä–∞–≥)</span></p>
                <p><strong>–û—Ç–Ω–æ—à–µ–Ω–∏–µ:</strong> -50</p>
                <p><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç:</strong> 1 –Ω–µ–¥–µ–ª—è –Ω–∞–∑–∞–¥</p>
                <button onclick="window.interactSocial('Viktor')">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                    </div>
                </div>
                    </div>

    <!-- –†–∞–±–æ—Ç–∞ -->
    <div id="work" class="content">
        <h2>–†–∞–±–æ—Ç–∞</h2>
        <div class="work-tabs" style="margin-bottom: 1rem; border-bottom: 1px solid #ccc; padding-bottom: 0.5rem;">
            <button onclick="window.openWorkSubTab(event, 'work_tasks')" class="work-tab-button active">–ó–∞–¥–∞—á–∏</button>
            <button onclick="window.openWorkSubTab(event, 'work_schedule')" class="work-tab-button">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
            <button onclick="window.openWorkSubTab(event, 'work_priorities')" class="work-tab-button">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</button>
                </div>

        <div id="work_tasks" class="work-sub-content active">
            <h3>–ó–∞–¥–∞—á–∏</h3>
            <button onclick="window.openAddTaskModal()">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
            <ul id="taskList" style="list-style: none; padding-left: 0;">
                <li style="padding: 0.5rem; background: #e9ecef; border-radius: 4px; margin-bottom: 0.5rem;">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–µ–Ω—É (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 1) <button onclick="window.setTaskPriority('wall', 2)">‚Üë</button> <button onclick="window.setTaskPriority('wall', 0)">‚Üì</button></li>
                <li style="padding: 0.5rem; background: #e9ecef; border-radius: 4px; margin-bottom: 0.5rem;">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é X (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2) <button onclick="window.setTaskPriority('research', 3)">‚Üë</button> <button onclick="window.setTaskPriority('research', 1)">‚Üì</button></li>
            </ul>
                    </div>

        <div id="work_schedule" class="work-sub-content">
            <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –î–Ω—è</h3>
            <div id="dailyScheduleContainer" style="display: grid; grid-template-columns: repeat(24, 1fr); gap: 2px; background: #f8f9fa; border: 1px solid #dee2e6; padding: 5px; height: 100px;">
                <!-- –ß–∞—Å—ã –¥–Ω—è –±—É–¥—É—Ç –∑–¥–µ—Å—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, div –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ -->
                <script>
                    const scheduleContainer = document.getElementById('dailyScheduleContainer');
                    if (scheduleContainer) {
                        for(let i=0; i<24; i++){
                            let hourBlock = document.createElement('div');
                            hourBlock.style.border = '1px solid #ccc';
                            hourBlock.style.background = '#fff';
                            hourBlock.title = i + ':00 - ' + (i+1) + ':00 - –°–≤–æ–±–æ–¥–Ω–æ';
                            hourBlock.textContent = i.toString().padStart(2, '0');
                            hourBlock.style.fontSize = '10px';
                            hourBlock.style.textAlign = 'center';
                            hourBlock.style.cursor = 'pointer';
                            hourBlock.onclick = () => alert('–ù–∞–∑–Ω–∞—á–∏—Ç—å –∑–∞–¥–∞—á—É –Ω–∞ ' + i + ':00');
                            scheduleContainer.appendChild(hourBlock);
                        }
                        // –ü—Ä–∏–º–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
                        if(scheduleContainer.children[8]) scheduleContainer.children[8].style.background = 'lightblue'; // –†–∞–±–æ—Ç–∞
                        if(scheduleContainer.children[9]) scheduleContainer.children[9].style.background = 'lightblue';
                        if(scheduleContainer.children[12]) scheduleContainer.children[12].style.background = 'lightgreen'; // –û—Ç–¥—ã—Ö
                        if(scheduleContainer.children[22]) scheduleContainer.children[22].style.background = 'darkgrey'; // –°–æ–Ω
                        if(scheduleContainer.children[23]) scheduleContainer.children[23].style.background = 'darkgrey';
                    }
                </script>
                </div>
            </div>

        <div id="work_priorities" class="work-sub-content">
            <h3>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –†–∞–±–æ—Ç</h3>
            <ul style="list-style: none; padding-left: 0;">
                <li>–ü–æ–∂–∞—Ä–æ—Ç—É—à–µ–Ω–∏–µ: <input type="number" value="1" min="0" max="4" style="width: 50px;"></li>
                <li>–ü–∞—Ü–∏–µ–Ω—Ç: <input type="number" value="1" min="0" max="4" style="width: 50px;"></li>
                <li>–î–æ–∫—Ç–æ—Ä: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>–ù–∞–¥–∑–∏—Ä–∞—Ç–µ–ª—å: <input type="number" value="3" min="0" max="4" style="width: 50px;"></li>
                <li>–ì–æ—Ç–æ–≤–∫–∞: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>–û—Ö–æ—Ç–∞: <input type="number" value="3" min="0" max="4" style="width: 50px;"></li>
                <li>–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>–†–µ–º–æ–Ω—Ç: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>–ü–µ—Ä–µ–Ω–æ—Å–∫–∞: <input type="number" value="4" min="0" max="4" style="width: 50px;"></li>
            </ul>
        </div>
                    </div>

    <!-- –í–µ—â–∏ (–±—ã–≤—à–∏–π –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å) -->
    <div id="items" class="content">
      <h2>–í–µ—â–∏ <button id="add-item-btn">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button> <button id="save-inventory-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</button></h2>
      <div>
          <button class="category-btn active" data-category="all">–í—Å–µ</button>
          <button class="category-btn" data-category="weapons">–û—Ä—É–∂–∏–µ</button>
          <button class="category-btn" data-category="clothing">–û–¥–µ–∂–¥–∞</button>
          <button class="category-btn" data-category="resources">–†–µ—Å—É—Ä—Å—ã</button>
          <button class="category-btn" data-category="medications">–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã</button>
                </div>
      <div id="inventory-list">
          <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
      <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –¥–ª—è –æ–ø—Ü–∏–π.</p>
      
      <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–∞ -->
      <div id="add-item-modal" style="display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: #fff; padding: 20px; border: 1px solid #ccc; z-index: 1000;">
          <h3>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</h3>
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ: <input type="text" id="item-name"></label><br>
          <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: 
              <select id="item-category">
                  <option value="weapons">–û—Ä—É–∂–∏–µ</option>
                  <option value="clothing">–û–¥–µ–∂–¥–∞</option>
                  <option value="resources">–†–µ—Å—É—Ä—Å—ã</option>
                  <option value="medications">–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã</option>
              </select>
          </label><br>
          <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="item-quantity" min="1" value="1"></label><br>
          <label>–û–ø–∏—Å–∞–Ω–∏–µ: <textarea id="item-description"></textarea></label><br>
          <button id="save-item-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button id="cancel-item-btn">–û—Ç–º–µ–Ω–∞</button>
                </div>
      <div id="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999;"></div>
        <div class="inventory-grid" id="inventoryGridContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; padding: 10px; background: #2A2A2A; border-radius: 4px; min-height: 200px; border: 1px solid #4A4A4A;">
            <!-- –Ø—á–µ–π–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è JavaScript -->
                    </div>
        <div id="itemContextMenu" class="context-menu" style="display:none; position:absolute; background:#383838; border:1px solid #5A5A5A; border-radius:3px; padding:5px; z-index:1000;">
            <button onclick="window.deleteContextItem()">–£–¥–∞–ª–∏—Ç—å</button>
            <button onclick="window.editContextItemName()">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                </div>
        <div style="margin-top:1rem;text-align:center;color:#A89F8D;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –¥–ª—è –æ–ø—Ü–∏–π.</div>
            </div>

    <!-- –ñ—É—Ä–Ω–∞–ª -->
    <div id="journal" class="content">
        <h2>–ñ—É—Ä–Ω–∞–ª –°–æ–±—ã—Ç–∏–π</h2>
        <div class="journal-filters" style="margin-bottom: 1rem;">
            <label for="journalDateFilter">–î–∞—Ç–∞:</label>
            <input type="date" id="journalDateFilter" onchange="filterJournalEvents()">
            <label for="journalTypeFilter">–¢–∏–ø:</label>
            <select id="journalTypeFilter" onchange="filterJournalEvents()">
                <option value="all">–í—Å–µ</option>
                <option value="combat">–ë–æ–π</option>
                <option value="social">–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ</option>
                <option value="work">–†–∞–±–æ—Ç–∞</option>
                <option value="health">–ó–¥–æ—Ä–æ–≤—å–µ</option>
                <option value="misc">–†–∞–∑–Ω–æ–µ</option>
            </select>
        </div>
        <ul id="journalEntryList" style="list-style: none; padding-left: 0; max-height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 0.5rem; border-radius: 4px; background: #f8f9fa;">
            <!-- –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ -->
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>08:15:</strong> –ê—Ç–∞–∫–∞ —Ä–µ–π–¥–µ—Ä–æ–≤! <span style="color: red;">[–ë–æ–π]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>10:30:</strong> –ï–ª–µ–Ω–∞ —Ä–∞—Å—Å–∫–∞–∑–∞–ª–∞ –∞–Ω–µ–∫–¥–æ—Ç. (+5 –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ) <span style="color: blue;">[–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>14:00:</strong> –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –ø–æ—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–Ω—ã. <span style="color: green;">[–†–∞–±–æ—Ç–∞]</span></li>
            <li style="padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>16:20:</strong> –ò–º—è—Ä–µ–∫ –ø–æ–ª—É—á–∏–ª —É—à–∏–± –ª–µ–≤–æ–π –Ω–æ–≥–∏. <span style="color: orange;">[–ó–¥–æ—Ä–æ–≤—å–µ]</span></li>
        </ul>
    </div>

    <!-- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã/–ò—Å—Ç–æ—Ä–∏—è -->
    <div id="procedures_history" class="content">
        <h2>–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –ò—Å—Ç–æ—Ä–∏—è –ë–æ–ª–µ–∑–Ω–µ–π</h2>
        <div class="history-filters" style="margin-bottom: 1rem;">
            <button onclick="window.filterHistory('all')">–í—Å—è –∏—Å—Ç–æ—Ä–∏—è</button>
            <button onclick="window.filterHistory('operations')">–û–ø–µ—Ä–∞—Ü–∏–∏</button>
            <button onclick="window.filterHistory('treatments')">–õ–µ—á–µ–Ω–∏–µ</button>
            <button onclick="window.filterHistory('illnesses')">–ë–æ–ª–µ–∑–Ω–∏</button>
            <button onclick="window.filterHistory('injuries')">–¢—Ä–∞–≤–º—ã</button>
                    </div>
        <ul id="medicalHistoryList" style="list-style: none; padding-left: 0; max-height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 0.5rem; border-radius: 4px; background: #f8f9fa;">
            <!-- –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ -->
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>–î–∞—Ç–∞: 2025-05-10</strong> - –û–ø–µ—Ä–∞—Ü–∏—è: –£–¥–∞–ª–µ–Ω–∏–µ –∞–ø–ø–µ–Ω–¥–∏–∫—Å–∞. –°—Ç–∞—Ç—É—Å: –£—Å–ø–µ—à–Ω–æ. <span style="color: purple;">[–û–ø–µ—Ä–∞—Ü–∏—è]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>–î–∞—Ç–∞: 2025-04-22</strong> - –ë–æ–ª–µ–∑–Ω—å: –ì—Ä–∏–ø–ø. –õ–µ—á–µ–Ω–∏–µ: –ü–æ—Å—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º, –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã. –°—Ç–∞—Ç—É—Å: –í—ã–∑–¥–æ—Ä–æ–≤–µ–ª. <span style="color: orange;">[–ë–æ–ª–µ–∑–Ω—å]</span></li>
            <li style="padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>–î–∞—Ç–∞: 2025-03-15</strong> - –¢—Ä–∞–≤–º–∞: –ü–µ—Ä–µ–ª–æ–º –ª–µ–≤–æ–π —Ä—É–∫–∏. –õ–µ—á–µ–Ω–∏–µ: –ì–∏–ø—Å. –°—Ç–∞—Ç—É—Å: –ó–∞–∂–∏–ª–æ. <span style="color: red;">[–¢—Ä–∞–≤–º–∞]</span></li>
        </ul>
                </div>

    <!-- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ -->
    <div id="planner" class="content">
      <div class="planner-root">
        <!-- –ë–∞–Ω–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã -->
        <div class="planner-currency-sidebar">
          <h2>–ë–∞–Ω–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã</h2>
          <div class="planner-converter-container">
            <div style="width:50px;height:50px;margin:0 auto 10px auto;background:#eee;border-radius:5px;text-align:center;line-height:50px;font-size:2em;color:#bbb;">‚ÇΩ</div>
            <input type="number" id="virtual-currency-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="0" class="planner-input">
            <button id="convert-currency-btn" class="planner-btn planner-btn-primary">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å (10:1)</button>
            <div id="currency-result" class="planner-result-box"></div>
                    </div>
          <div class="planner-conversion-history">
            <h3>–ò—Å—Ç–æ—Ä–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π</h3>
            <div id="conversion-list"></div>
            <button id="clear-history" class="planner-btn planner-btn-secondary" style="margin-top: 10px; width: 100%;">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>
          <div class="planner-progress-container">
            <input type="number" id="savings-goal" placeholder="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å (–≤ —Ä—É–±–ª—è—Ö)" min="1" class="planner-input">
            <div class="planner-progress-bar">
              <div class="planner-progress-fill" id="progress-fill" style="width: 0%;"></div>
                    </div>
            <p class="planner-progress-text" id="progress-text">0% (0 / 0 —Ä—É–±.)</p>
                </div>
            </div>
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <div class="planner-main-content">
          <div class="planner-center-content">
            <div class="planner-container">
              <button id="toggle-theme" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" class="planner-btn planner-btn-theme"><i class="fas fa-moon"></i></button>
              <h1>–°–ø–∏—Å–æ–∫ –¥–µ–ª</h1>
              <div class="planner-input-group">
                <input type="text" id="new-task" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏..." aria-label="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" class="planner-input">
                <select id="importance" aria-label="–í–∞–∂–Ω–æ—Å—Ç—å" class="planner-select">
                  <option value="important" selected>–í–∞–∂–Ω–æ</option>
                  <option value="notImportant">–ù–µ –≤–∞–∂–Ω–æ</option>
                </select>
                <select id="urgency" aria-label="–°—Ä–æ—á–Ω–æ—Å—Ç—å" class="planner-select">
                  <option value="urgent" selected>–°—Ä–æ—á–Ω–æ</option>
                  <option value="notUrgent">–ù–µ —Å—Ä–æ—á–Ω–æ</option>
                </select>
                <select id="priority" aria-label="–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç" class="planner-select">
                  <option value="low">–ù–∏–∑–∫–∏–π</option>
                  <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                  <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                  <option value="boss">–ë–æ—Å—Å</option>
                </select>
                <input type="date" id="due-date" title="–î–µ–¥–ª–∞–π–Ω (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" aria-label="–î–∞—Ç–∞ –¥–µ–¥–ª–∞–π–Ω–∞" class="planner-input">
                <button id="add-task" aria-label="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É" class="planner-btn planner-btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
              <ul id="task-list" class="planner-task-list"></ul>
              <div class="planner-filters">
                <button id="show-all" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏" class="planner-btn planner-btn-secondary">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</button>
                <button id="show-active" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏" class="planner-btn planner-btn-blue">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                <button id="show-completed" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏" class="planner-btn planner-btn-green">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</button>
                    </div>
              <div class="planner-gamification">
                <h2>–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
                <p>–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></p>
                <p>–û–ø—ã—Ç (XP): <span id="xp">0</span></p>
                <p>–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞: <span id="currency">0</span></p>
                <p>–ó–¥–æ—Ä–æ–≤—å–µ (HP): <span id="hp">100</span></p>
                </div>
              <div class="planner-stats">
                <p>–í—Å–µ–≥–æ –∑–∞–¥–∞—á (—Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ): <span id="total-tasks">0</span></p>
                <p>–í—ã–ø–æ–ª–Ω–µ–Ω–æ (–æ—Å–Ω–æ–≤–Ω—ã—Ö): <span id="completed-tasks">0</span></p>
                <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö (–æ—Å–Ω–æ–≤–Ω—ã—Ö): <span id="active-tasks">0</span></p>
                    </div>
                </div>
            </div>
          <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
          <div class="planner-right-sidebar">
            <div class="planner-calendar-sidebar">
              <h2>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–¥–∞—á</h2>
              <div class="planner-calendar-header">
                <div class="planner-calendar-nav">
                  <button id="prev-month" class="planner-btn planner-btn-secondary"><i class="fas fa-chevron-left"></i></button>
                  <button id="next-month" class="planner-btn planner-btn-secondary"><i class="fas fa-chevron-right"></i></button>
                </div>
                <h3 id="current-month-year">–ú–∞–π 2023</h3>
              </div>
              <div class="planner-calendar-grid" id="calendar-days-header">
                <div class="planner-calendar-day-header">–ü–Ω</div>
                <div class="planner-calendar-day-header">–í—Ç</div>
                <div class="planner-calendar-day-header">–°—Ä</div>
                <div class="planner-calendar-day-header">–ß—Ç</div>
                <div class="planner-calendar-day-header">–ü—Ç</div>
                <div class="planner-calendar-day-header">–°–±</div>
                <div class="planner-calendar-day-header">–í—Å</div>
              </div>
              <div class="planner-calendar-grid" id="calendar-days"></div>
            </div>
            <div class="planner-achievements-sidebar">
              <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
              <div class="planner-add-achievement">
                <input type="text" id="achievement-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è" aria-label="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è" class="planner-input">
                <input type="text" id="achievement-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" aria-label="–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è" class="planner-input">
                <button id="add-achievement-btn" class="planner-btn planner-btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
              </div>
              <div id="achievements-list"></div>
            </div>
          </div>
        </div>
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
        <div class="planner-task-modal" id="task-modal">
          <div class="planner-task-modal-content">
            <span class="planner-task-modal-close">√ó</span>
            <h3 id="modal-date">–ó–∞–¥–∞—á–∏ –Ω–∞ 1 –º–∞—è 2023</h3>
            <ul id="modal-task-list"></ul>
          </div>
        </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞ –∑–¥–æ—Ä–æ–≤—å—è -->
    <div class="modal" id="healthLogModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:100;justify-content:center;align-items:center;">
        <div class="modal-content" style="background:#ffffff;padding:20px;border-radius:10px;max-width:500px;width:100%;position:relative;">
            <span class="close-button" onclick="window.closeHealthLogModal()" style="position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;">&times;</span>
            <h3 style="margin-top:0;">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –æ –∑–¥–æ—Ä–æ–≤—å–µ</h3>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="sleep">–°–æ–Ω (—á–∞—Å–æ–≤):</label>
                <input type="number" id="sleep" min="0" max="24" step="0.5" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                    </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="water">–í–æ–¥–∞ (–ª–∏—Ç—Ä–æ–≤):</label>
                <input type="number" id="water" min="0" max="10" step="0.1" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="healthNote">–ó–∞–º–µ—Ç–∫–∞:</label>
                <textarea id="healthNote" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;min-height:100px;"></textarea>
                    </div>
            <button onclick="window.addHealthEntry()" style="background:#4CAF50;color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;width:100%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
                </div>
                    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è RPG —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∑–¥–æ—Ä–æ–≤—å—è -->
    <div class="modal" id="healthStatModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:100;justify-content:center;align-items:center;">
        <div class="modal-content" style="background:#ffffff;padding:20px;border-radius:10px;max-width:500px;width:100%;position:relative;">
            <span class="close-button" onclick="window.closeHealthStatModal()" style="position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;">&times;</span>
            <h3 id="healthStatModalTitle" style="margin-top:0;">–î–æ–±–∞–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É –∑–¥–æ—Ä–æ–≤—å—è</h3>
            <input type="hidden" id="editingStatIndex" value="-1">
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statName">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="statName" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statValue">–ó–Ω–∞—á–µ–Ω–∏–µ:</label>
                <input type="text" id="statValue" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statUnit">–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è:</label>
                <input type="text" id="statUnit" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
        </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select id="statCategory" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                    <option value="–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ">–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                    <option value="–ñ–∏–∑–Ω–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏">–ñ–∏–∑–Ω–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</option>
                    <option value="–ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ">–ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                    <option value="–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</option>
                    <option value="–¢—Ä–∞–≤–º—ã/–ë–æ–ª–µ–∑–Ω–∏">–¢—Ä–∞–≤–º—ã/–ë–æ–ª–µ–∑–Ω–∏</option>
                    <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                </select>
                    </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statComment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                <textarea id="statComment" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;min-height:60px;"></textarea>
                </div>
            <button onclick="window.saveHealthStat()" style="background:#4CAF50;color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;width:100%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É</button>
                    </div>
                </div>

    <!-- –û—Ç–Ω–æ—à–µ–Ω–∏—è -->
    <div id="relationships" class="content">
        <h2>–û—Ç–Ω–æ—à–µ–Ω–∏—è</h2>
        <div>
            <input type="text" id="relationshipName" placeholder="–ò–º—è">
            <input type="date" id="nextContact">
            <button onclick="window.addRelationship()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        <div id="relationshipList"></div>
        </div>

    <!-- –ù–∞–≤—ã–∫–∏ -->
    <div id="skills" class="content">
        <h2>–ù–∞–≤—ã–∫–∏</h2>
        <div>
            <input type="text" id="skillName" placeholder="–ù–∞–≤—ã–∫">
            <select id="skillCategory">
                <option value="–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                <option value="–î–∏–∑–∞–π–Ω">–î–∏–∑–∞–π–Ω</option>
                <option value="VR/AR">VR/AR</option>
            </select>
            <button onclick="window.addSkill()">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
        <div id="skillList"></div>
    </div>

    <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
    <div id="inventory" class="content">
        <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
        <div id="inventoryGrid" style="display:grid;grid-template-columns:repeat(6,60px);gap:12px;max-width:400px;margin:2rem auto 0 auto;"></div>
        <div style="margin-top:2rem;text-align:center;color:#888;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏</div>
                </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div class="modal" id="scheduleOperationModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:100;justify-content:center;align-items:center;">
        <div class="modal-content" style="background:#ffffff;padding:20px;border-radius:10px;max-width:500px;width:100%;position:relative;">
            <span class="close-button" onclick="window.closeScheduleOperationModal()" style="position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;">&times;</span>
            <h3 style="margin-top:0;">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é/–ø—Ä–æ—Ü–µ–¥—É—Ä—É</h3>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="operationDate">–î–∞—Ç–∞:</label>
                <input type="date" id="operationDate" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="operationName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã/–æ–ø–µ—Ä–∞—Ü–∏–∏:</label>
                <input type="text" id="operationName" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="operationStatus">–°—Ç–∞—Ç—É—Å:</label>
                <select id="operationStatus" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                    <option value="–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</option>
                    <option value="–í—ã–ø–æ–ª–Ω–µ–Ω–æ">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                    <option value="–û—Ç–º–µ–Ω–µ–Ω–æ">–û—Ç–º–µ–Ω–µ–Ω–æ</option>
                </select>
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="operationNotes">–ó–∞–º–µ—Ç–∫–∏:</label>
                <textarea id="operationNotes" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;min-height:100px;"></textarea>
            </div>
            <button onclick="window.saveOperationEntry()" style="background:#4CAF50;color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;width:100%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="planner.js"></script>
    
    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –∫–æ–ª–µ—Å–∞ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ -->
    <script>
        let lifeBalanceChart;
        
        // –û–±–ª–∞—Å—Ç–∏ –∂–∏–∑–Ω–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        const defaultLifeAreas = [
            { name: '–ó–¥–æ—Ä–æ–≤—å–µ', value: 7, color: '#FF6384' },
            { name: '–ö–∞—Ä—å–µ—Ä–∞', value: 6, color: '#36A2EB' },
            { name: '–§–∏–Ω–∞–Ω—Å—ã', value: 5, color: '#FFCE56' },
            { name: '–û—Ç–Ω–æ—à–µ–Ω–∏—è', value: 8, color: '#4BC0C0' },
            { name: '–°–µ–º—å—è', value: 7, color: '#9966FF' },
            { name: '–î—Ä—É–∑—å—è', value: 6, color: '#FF9F40' },
            { name: '–•–æ–±–±–∏', value: 4, color: '#FF6384' },
            { name: '–†–∞–∑–≤–∏—Ç–∏–µ', value: 5, color: '#C9CBCF' },
            { name: '–î—É—Ö–æ–≤–Ω–æ—Å—Ç—å', value: 3, color: '#4BC0C0' },
            { name: '–û—Ç–¥—ã—Ö', value: 6, color: '#36A2EB' }
        ];
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
        function loadLifeBalanceData() {
            const saved = localStorage.getItem('lifeBalanceData');
            return saved ? JSON.parse(saved) : defaultLifeAreas;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveLifeBalance() {
            const areas = [];
            const controls = document.querySelectorAll('#lifeBalanceControls .life-area-control');
            controls.forEach((control, index) => {
                const nameInput = control.querySelector('.area-name');
                const valueInput = control.querySelector('.area-value');
                areas.push({
                    name: nameInput.value,
                    value: parseInt(valueInput.value),
                    color: defaultLifeAreas[index % defaultLifeAreas.length].color
                });
            });
            localStorage.setItem('lifeBalanceData', JSON.stringify(areas));
            updateChart(areas);
            updateStats(areas);
            alert('–î–∞–Ω–Ω—ã–µ –∫–æ–ª–µ—Å–∞ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }
        
        // –°–±—Ä–æ—Å –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        function resetLifeBalance() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é?')) {
                localStorage.removeItem('lifeBalanceData');
                initLifeBalanceChart();
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function createControls(areas) {
            const container = document.getElementById('lifeBalanceControls');
            container.innerHTML = '';
            
            areas.forEach((area, index) => {
                const controlDiv = document.createElement('div');
                controlDiv.className = 'life-area-control';
                controlDiv.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    padding: 5px;
                    background: white;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                `;
                
                controlDiv.innerHTML = `
                    <div style="width: 20px; height: 20px; background: ${area.color}; border-radius: 50%; flex-shrink: 0;"></div>
                    <input type="text" class="area-name" value="${area.name}" 
                           style="flex: 1; border: none; background: transparent; font-size: 0.9em; outline: none;">
                    <input type="range" class="area-value" min="0" max="10" value="${area.value}" 
                           style="width: 80px;" 
                           oninput="updateChartRealtime()">
                    <span class="area-value-display" style="min-width: 20px; font-weight: bold; color: #495057;">${area.value}</span>
                `;
                
                container.appendChild(controlDiv);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ª–∞–π–¥–µ—Ä–∞
                const slider = controlDiv.querySelector('.area-value');
                const display = controlDiv.querySelector('.area-value-display');
                slider.addEventListener('input', function() {
                    display.textContent = this.value;
                });
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        function updateChartRealtime() {
            const areas = [];
            const controls = document.querySelectorAll('#lifeBalanceControls .life-area-control');
            controls.forEach((control, index) => {
                const nameInput = control.querySelector('.area-name');
                const valueInput = control.querySelector('.area-value');
                areas.push({
                    name: nameInput.value,
                    value: parseInt(valueInput.value),
                    color: defaultLifeAreas[index % defaultLifeAreas.length].color
                });
            });
            updateChart(areas);
            updateStats(areas);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
        function updateChart(areas) {
            if (lifeBalanceChart) {
                lifeBalanceChart.data.labels = areas.map(area => area.name);
                lifeBalanceChart.data.datasets[0].data = areas.map(area => area.value);
                lifeBalanceChart.data.datasets[0].backgroundColor = areas.map(area => area.color + '40');
                lifeBalanceChart.data.datasets[0].borderColor = areas.map(area => area.color);
                lifeBalanceChart.update('none');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats(areas) {
            const average = areas.reduce((sum, area) => sum + area.value, 0) / areas.length;
            const avgElement = document.getElementById('averageScore');
            const statusElement = document.getElementById('balanceStatus');
            
            if (avgElement) {
                avgElement.textContent = average.toFixed(1);
            }
            
            if (statusElement) {
                let status = '–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è';
                let color = '#dc3545';
                
                if (average >= 8) {
                    status = '–û—Ç–ª–∏—á–Ω—ã–π –±–∞–ª–∞–Ω—Å!';
                    color = '#28a745';
                } else if (average >= 6) {
                    status = '–•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å';
                    color = '#ffc107';
                } else if (average >= 4) {
                    status = '–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–∞–Ω—Å';
                    color = '#fd7e14';
                }
                
                statusElement.textContent = status;
                statusElement.style.color = color;
                statusElement.style.fontWeight = 'bold';
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã
        function initLifeBalanceChart() {
            const areas = loadLifeBalanceData();
            createControls(areas);
            
            const ctx = document.getElementById('lifeBalanceChart');
            if (!ctx) return;
            
            // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–∏–∞–≥—Ä–∞–º–º—É –µ—Å–ª–∏ –µ—Å—Ç—å
            if (lifeBalanceChart) {
                lifeBalanceChart.destroy();
            }
            
            lifeBalanceChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: areas.map(area => area.name),
                    datasets: [{
                        label: '–£—Ä–æ–≤–µ–Ω—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏',
                        data: areas.map(area => area.value),
                        backgroundColor: areas.map(area => area.color + '40'),
                        borderColor: areas.map(area => area.color),
                        borderWidth: 2,
                        pointBackgroundColor: areas.map(area => area.color),
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.r + '/10';
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: 10,
                            stepSize: 1,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            grid: {
                                color: '#4A4A4A',
                                lineWidth: 1
                            },
                            angleLines: {
                                color: '#4A4A4A',
                                lineWidth: 1
                            },
                            pointLabels: {
                                color: '#2E2E2E',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            ticks: {
                                color: '#4A4A4A',
                                font: {
                                    size: 10
                                },
                                stepSize: 2,
                                showLabelBackdrop: false
                            }
                        }
                    },
                    interaction: {
                        intersect: false
                    },
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            
            updateStats(areas);
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ HTML
        window.saveLifeBalance = saveLifeBalance;
        window.resetLifeBalance = resetLifeBalance;
        window.updateChartRealtime = updateChartRealtime;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ Chart.js
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    initLifeBalanceChart();
                } else {
                    console.error('Chart.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
            }, 100);
        });
    </script>
      <!-- ================= –ß–ê–¢-–ë–û–¢ ================= -->
  <div id="chat-container" style="position: fixed; bottom: 20px; right: 20px; width: 300px;
                                    background: #fff; border: 1px solid #ccc; border-radius: 8px;
                                    box-shadow: 0 2px 10px rgba(0,0,0,.1); z-index: 999;">
    <div id="chat-header" style="padding: 10px; border-bottom: 1px solid #eee;
                                 font-weight: bold; cursor: pointer;
                                 display: flex; justify-content: space-between; align-items: center;"
         onclick="toggleChatCollapse()">
      <span>–ü–æ–º–æ—â–Ω–∏–∫</span>
      <span id="chat-toggle-icon" style="font-size: 14px; user-select: none;">‚ñº</span>
                </div>
    <div id="chat-messages" style="height: 200px; overflow-y: auto; padding: 10px; font-size: 14px;">
      <!-- —Å—é–¥–∞ –±—É–¥—É—Ç –ø–∞–¥–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è -->
    </div>
    <div id="chat-input" style="display: flex; border-top: 1px solid #eee;">
      <input id="chat-text" type="text" placeholder="–í–∞—à –≤–æ–ø—Ä–æ—Å‚Ä¶"
             style="flex:1; border:none; padding:8px; outline:none;">
      <button id="chat-send" style="border:none; padding:0 12px; cursor:pointer;">‚ñ∂</button>
    </div>
  </div>
  <!-- =========================================== -->

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è —á–∞—Ç–∞
    let isChatCollapsed = false;
    
    function toggleChatCollapse() {
      const chatMessages = document.getElementById("chat-messages");
      const chatInput = document.getElementById("chat-input");
      const toggleIcon = document.getElementById("chat-toggle-icon");
      
      if (isChatCollapsed) {
        // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
        chatMessages.style.display = "block";
        chatInput.style.display = "flex";
        toggleIcon.textContent = "‚ñº";
        isChatCollapsed = false;
      } else {
        // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
        chatMessages.style.display = "none";
        chatInput.style.display = "none";
        toggleIcon.textContent = "‚ñ≤";
        isChatCollapsed = true;
      }
    }
    
    // 1) –§—É–Ω–∫—Ü–∏—è –æ–±—â–µ–Ω–∏—è —Å LM Studio —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API
    async function queryLMStudio(prompt, contextTasks) {
      const messages = [
        {
          role: "system",
          content:
            "–¢—ã ‚Äî –ø–æ–º–æ—à–Ω–∏–∫. " +
            "–í–æ—Ç —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á:\n" +
            contextTasks.map((t, i) => `${i + 1}. ${t.text}`).join("\n")
        },
        { role: "user", content: prompt }
      ];

      const res = await fetch("http://127.0.0.1:1234/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer lm-studio"  // –µ—Å–ª–∏ –≤—ã –º–µ–Ω—è–ª–∏ API Key, –≤–ø–∏—à–∏—Ç–µ —Å–≤–æ–π
        },
        body: JSON.stringify({
          model: "hermes-3-llama-3.2-3b",
          messages: messages
        })
      });

      if (!res.ok) {
        const err = await res.text();
        throw new Error(`LM Studio API error ${res.status}: ${err}`);
      }
      const json = await res.json();
      return json.choices[0].message.content;
    }

    // 2) –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ–∫–Ω–æ —á–∞—Ç–∞
    function appendMessage(text, fromUser = true) {
      const container = document.getElementById("chat-messages");
      const div = document.createElement("div");
      div.style.margin = "6px 0";
      div.style.textAlign = fromUser ? "right" : "left";
      div.textContent = text;
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
    }

    // 3) –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö LifePlanner
    function loadTasks() {
      try {
        return LifePlanner.getData().tasks || [];
      } catch (e) {
        // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ LifePlanner –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        return JSON.parse(localStorage.getItem("tasks") || "[]");
      }
    }

    // 4) –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
    document.getElementById("chat-send").addEventListener("click", async () => {
      const input = document.getElementById("chat-text");
      const question = input.value.trim();
      if (!question) return;
      appendMessage(question, true);
      input.value = "";
      try {
        const tasks = loadTasks();
        const answer = await queryLMStudio(question, tasks);
        appendMessage(answer, false);
      } catch (e) {
        appendMessage("–û—à–∏–±–∫–∞: " + e.message, false);
      }
    });

    // 5) –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ Enter
    document.getElementById("chat-text").addEventListener("keypress", e => {
      if (e.key === "Enter") {
        document.getElementById("chat-send").click();
        e.preventDefault();
      }
    });
  </script>

</html>