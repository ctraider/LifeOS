<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeOS - RimWorld Edition</title>
    <style>
      #inventory-list {
    border: 1px solid #ccc;
    padding: 10px;
    min-height: 100px;
    background-color: #f9f9f9;
}

.item {
    padding: 5px;
    margin: 5px 0;
    background-color: #fff;
    border: 1px solid #ddd;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.item button {
    margin-left: 10px;
    background-color: #ff4444;
    color: white;
    border: none;
    padding: 2px 5px;
    cursor: pointer;
}

.item button:hover {
    background-color: #cc0000;
}

.category-btn {
    margin: 5px;
    padding: 5px 10px;
    cursor: pointer;
}

.category-btn.active {
    background-color: #4CAF50;
    color: white;
}

#add-item-modal label {
    display: block;
    margin: 10px 0;
}

#add-item-modal input, #add-item-modal select, #add-item-modal textarea {
    width: 100%;
    padding: 5px;
}

#add-item-modal textarea {
    height: 60px;
}
        /* RimWorld Inspired Styles */
        @font-face {
            font-family: 'RimWorld'; /* Using a generic name, will fallback to sans-serif */
            /* In a real scenario, you'd link a specific font file if available and licensed */
            src: local('Arial'), local('Helvetica'), sans-serif; /* Fallback fonts */
        }

        body {
            font-family: 'RimWorld', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            background: #2E2E2E; /* Dark gray, common in RimWorld UI */
            color: #D1C7B7; /* Light beige/off-white text */
            font-size: 14px;
        }

        header {
            background: #1A1A1A; /* Very dark gray for header */
            color: #D1C7B7;
            padding: 0.5rem 1rem;
            text-align: left; /* RimWorld UI often has left-aligned titles in panels */
            border-bottom: 2px solid #4A4A4A; /* Darker border */
            position: relative;
        }

        header h1 {
            margin: 0;
            font-size: 1.5em;
            font-weight: normal;
        }

        .level {
            font-size: 0.9em;
            color: #A89F8D;
            margin-top: 0.25rem;
        }

        .xp-bar {
            width: 100%;
            height: 10px;
            background: #4A4A4A; /* Darker background for XP bar */
            border-radius: 2px;
            overflow: hidden;
            margin: 0.5rem 0;
            border: 1px solid #1A1A1A;
        }

        .xp-progress {
            height: 100%;
            width: 0%;
            background: #7A6A53; /* Muted gold/brown for progress */
            transition: width 0.3s;
        }

        #themeToggle {
            background: #4A4A4A;
            color: #D1C7B7;
            border: 1px solid #1A1A1A;
            padding: 0.3rem 0.6rem;
            font-size: 0.9em;
            cursor: pointer;
            border-radius: 3px;
        }
        #themeToggle:hover {
            background: #5A5A5A;
        }

        .tabs {
            display: flex;
            justify-content: flex-start; /* Tabs usually start from left */
            background: #252525; /* Slightly lighter dark gray for tab bar */
            border-bottom: 2px solid #4A4A4A;
            padding: 0 0.5rem; /* Padding for the tab container */
        }

        .tab {
            padding: 0.6rem 1rem;
            cursor: pointer;
            text-align: center;
            transition: background 0.2s, color 0.2s;
            border: 1px solid transparent; /* For border effect on active/hover */
            border-bottom: none;
            margin-right: 2px; /* Spacing between tabs */
            color: #A89F8D; /* Muted color for inactive tabs */
            font-size: 0.95em;
            border-radius: 3px 3px 0 0;
        }

        .tab:hover {
            background: #383838;
            color: #E1D7C7;
        }

        .tab.active {
            background: #3F3F3F; /* Active tab background - often a bit lighter or different shade */
            color: #FFFFFF; /* White or very light color for active tab text */
            border-left: 1px solid #4A4A4A;
            border-top: 1px solid #4A4A4A;
            border-right: 1px solid #4A4A4A;
            position: relative;
            /* top: -1px; /* Slight lift effect */
        }

        .main-container {
            display: flex; /* For main content and side panel */
        }

        .content-area {
            flex-grow: 1;
            /* border-left: 2px solid #4A4A4A; */ /* Separator for side panel */
        }
        
        .content {
            padding: 1rem;
            display: none;
            animation: fadeIn 0.2s;
            background: #333333; /* Main content area background */
            border-top: 1px solid #4A4A4A;
        }

        .content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        h2, h3 {
            color: #E1D7C7; /* Lighter text for headings */
            border-bottom: 1px solid #4A4A4A;
            padding-bottom: 0.3rem;
            margin-top: 0;
            margin-bottom: 0.8rem;
            font-weight: normal;
            font-size: 1.2em;
        }
        h3 {
            font-size: 1.1em;
            color: #C1B7A7;
        }

        /* General elements styling */
        input[type="text"], input[type="number"], input[type="date"], select, textarea {
            padding: 0.5rem;
            margin-right: 0.5rem;
            border-radius: 3px;
            border: 1px solid #5A5A5A;
            background: #2A2A2A;
            color: #D1C7B7;
            outline: none;
            transition: border 0.2s;
            margin-bottom: 0.5rem; /* Spacing */
        }

        input[type="text"]:focus, input[type="number"]:focus, input[type="date"]:focus, select:focus, textarea:focus {
            border: 1px solid #7A6A53; /* Highlight color on focus */
        }
        
        textarea {
            width: calc(100% - 1.2rem); /* Adjust width considering padding */
            min-height: 60px;
            resize: vertical;
        }

        button {
            padding: 0.5rem 1rem;
            background: #5A5A5A; /* Button background */
            border: 1px solid #404040; /* Button border */
            color: #D1C7B7;
            border-radius: 3px;
            cursor: pointer;
            font-weight: normal;
            transition: background 0.2s, border-color 0.2s;
            font-size: 0.95em;
            margin: 0.2rem;
        }

        button:hover {
            background: #6A6A6A;
            border-color: #505050;
            color: #FFFFFF;
        }
        
        button:active {
            background: #4A4A4A;
        }

        progress {
            width: 100%;
            height: 12px;
            border-radius: 2px;
            border: 1px solid #4A4A4A;
            background-color: #2A2A2A;
        }

        progress::-webkit-progress-bar {
            background-color: #2A2A2A;
            border-radius: 2px;
        }

        progress::-webkit-progress-value {
            background-color: #7A6A53; /* Muted gold/brown for progress value */
            border-radius: 2px;
        }

        progress::-moz-progress-bar { /* Firefox */
            background-color: #7A6A53;
            border-radius: 2px;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        li {
            padding: 0.3rem 0;
        }

        /* Specific section styles */
        .summary-section, .persona-section, .need-item, .health-overview, .health-section, .social-entry, .work-sub-content > ul > li, .inventory-cell, #journalEntryList > li, #medicalHistoryList > li {
            background: #383838; /* Slightly lighter background for content boxes */
            padding: 0.8rem;
            border-radius: 4px;
            border: 1px solid #4A4A4A;
            margin-bottom: 0.8rem;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        
        .persona-avatar {
            background: #4A4A4A !important; /* Darker for avatar placeholder */
            border: 1px solid #2A2A2A !important;
            color: #888 !important;
        }

        .inventory-cell {
            background: #4A4A4A !important;
            border: 1px solid #5A5A5A !important;
            color: #C1B7A7;
            font-size: 0.85em;
            word-wrap: break-word;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            text-align: center;
            min-height: 60px; /* Ensure cells have some height */
        }
        
        #dailyScheduleContainer div {
            border: 1px solid #4A4A4A !important;
            background: #383838 !important;
            color: #A89F8D;
        }
        #dailyScheduleContainer div[style*="lightblue"] { background: #4A5A6A !important; } /* Work */
        #dailyScheduleContainer div[style*="lightgreen"] { background: #5A6A4A !important; } /* Recreation */
        #dailyScheduleContainer div[style*="darkgrey"] { background: #202020 !important; } /* Sleep */

        /* Context Panel (Placeholder) */
        .context-panel {
            width: 250px; /* Adjust as needed */
            background: #252525;
            padding: 1rem;
            border-left: 2px solid #4A4A4A;
            min-height: calc(100vh - 50px); /* Adjust based on header height */
            color: #A89F8D;
        }
        .context-panel h3 {
            color: #D1C7B7;
            border-bottom-color: #5A5A5A;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .tabs { 
                flex-wrap: wrap; /* Allow tabs to wrap on smaller screens */
            }
            .tab {
                flex-basis: 33.33%; /* 3 tabs per row approx */
                font-size: 0.9em;
                padding: 0.5rem;
            }
            .main-container {
                flex-direction: column;
            }
            .context-panel {
                width: 100%;
                min-height: auto;
                border-left: none;
                border-top: 2px solid #4A4A4A;
            }
            header h1 { font-size: 1.2em; }
        }

        /* Dark theme (already dark by default, this is for consistency if themeToggle is used) */
        body.dark {
            /* Styles are already dark, this is a placeholder if light theme was primary */
        }
        /* Add any specific overrides for a hypothetical light theme if needed */

    </style>
    <style>
    .planner-root {
      display: flex;
      flex-direction: row;
      width: 100%;
      min-height: 600px;
      background: none;
    }
    .planner-currency-sidebar {
      width: 250px;
      margin-right: 20px;
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px var(--shadow-color);
      height: fit-content;
    }
    .planner-main-content {
      flex: 1;
      display: flex;
      flex-direction: row;
      min-width: 0;
    }
    .planner-center-content {
      flex: 1;
      max-width: 800px;
      min-width: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .planner-container {
      background-color: var(--card-bg);
      width: 100%;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 4px 10px var(--shadow-color);
      position: relative;
      margin-bottom: 20px;
    }
    .planner-right-sidebar {
      width: 300px;
      margin-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 250px;
    }
    .planner-calendar-sidebar, .planner-achievements-sidebar {
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px var(--shadow-color);
      height: fit-content;
    }
    .planner-calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .planner-calendar-nav {
      display: flex;
      gap: 10px;
    }
    .planner-calendar-nav button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-color);
    }
    .planner-calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    .planner-calendar-day-header {
      text-align: center;
      font-weight: bold;
      padding: 5px;
    }
    .planner-task-list {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .planner-task-item {
      background-color: var(--card-bg);
      margin-bottom: 15px;
      padding: 15px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-shadow: 0 2px 5px var(--shadow-color);
      opacity: 0;
      transform: translateY(10px);
      transition: transform var(--transition-duration), opacity var(--transition-duration);
    }
    .planner-task-item.show {
      opacity: 1;
      transform: translateY(0);
    }
    .planner-task-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    .planner-task-left {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }
    .planner-toggle-subtasks-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-color);
    }
    .planner-filters {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .planner-filters button {
      padding: 10px 15px;
      background-color: var(--secondary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .planner-gamification, .planner-stats {
      margin-top: 25px;
      padding: 15px;
      border-top: 1px solid var(--border-color);
    }
    .planner-gamification h2 {
      margin-bottom: 10px;
      text-align: center;
    }
    .planner-input-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .planner-input-group input[type="text"],
    .planner-input-group input[type="date"],
    .planner-input-group select {
      flex: 1;
      min-width: 120px;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-size: 16px;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    .planner-input-group button {
      padding: 12px 20px;
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .planner-result-box {
      margin-top: 10px;
      padding: 10px;
      background-color: var(--background-color);
      border: 1px solid var(--border-color);
      border-radius: 5px;
      text-align: center;
      display: none;
    }
    .planner-conversion-history {
      margin-top: 15px;
      max-height: 200px;
      overflow-y: auto;
    }
    .planner-conversion-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      border-bottom: 1px solid var(--border-color);
    }
    .planner-conversion-item button {
      background: none;
      border: none;
      color: var(--btn-delete);
      cursor: pointer;
    }
    .planner-progress-container {
      margin-top: 15px;
    }
    .planner-progress-container input {
      width: 100%;
      margin-bottom: 10px;
    }
    .planner-progress-bar {
      width: 100%;
      background-color: #ddd;
      border-radius: 5px;
      height: 20px;
      overflow: hidden;
    }
    .planner-progress-fill {
      height: 100%;
      background-color: var(--primary-color);
      transition: width var(--transition-duration);
    }
    .planner-progress-text {
      text-align: center;
      margin-top: 5px;
    }
    .planner-task-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    .planner-task-modal-content {
      background-color: var(--card-bg);
      padding: 20px;
      border-radius: 10px;
      width: 80%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .planner-task-modal-close {
      float: right;
      cursor: pointer;
      font-size: 20px;
    }
    .planner-achievement {
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
    }
    .planner-add-achievement {
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .planner-add-achievement input {
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    .planner-add-achievement button {
      padding: 10px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color var(--transition-duration);
    }
    .planner-add-achievement button:hover {
      background-color: var(--btn-hover);
    }
    .planner-delete-achievement-btn {
      background: none;
      border: none;
      color: var(--btn-delete);
      cursor: pointer;
      font-size: 16px;
      padding: 5px;
    }
    .planner-delete-achievement-btn:hover {
      color: #c82333;
    }
    </style>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <!-- Chart.js для лепестковой диаграммы -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
    :root {
      --primary-color: #4CAF50;
      --secondary-color: #007bff;
      --background-color: #f9f9f9;
      --card-bg: #ffffff;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --text-color: #333333;
      --border-color: #dddddd;
      --btn-hover: #43A047;
      --btn-edit: #FFC107;
      --btn-delete: #DC3545;
      --primary-color: #0074D9; /* Blue */
      --secondary-color: #FF4136; /* Red */
      --background-color: #F5F5F5; /* Light Gray */
      --card-bg: #FFFFFF; /* White */
      --shadow-color: rgba(0, 0, 0, 0.1);
      --text-color: #111111; /* Very Dark Gray */
      --border-color: #DDDDDD; /* Light Gray */
      --btn-hover: #0056b3; /* Darker Blue */
      --btn-edit: #FF851B; /* Orange */
      --btn-delete: #85144b; /* Dark Red */
      --transition-duration: 0.3s;
    }
    .dark-theme {
      --background-color: #1e1e1e;
      --card-bg: #2c2c2c;
      --text-color: #e0e0e0;
      --border-color: #444444;
      --shadow-color: rgba(0, 0, 0, 0.5);
    }
    .currency-sidebar {
      width: 250px;
      margin-right: 20px;
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px var(--shadow-color);
      transition: background-color var(--transition-duration);
      height: fit-content;
    }
    .currency-sidebar h2 {
      margin-bottom: 15px;
      text-align: center;
      color: var(--text-color);
    }
    .converter-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .converter-container img {
      width: 50px;
      height: 50px;
      margin: 0 auto;
      margin-bottom: 10px;
    }
    .converter-container input {
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    .converter-container button {
      padding: 10px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color var(--transition-duration);
    }
    .converter-container button:hover {
      background-color: var(--btn-hover);
    }
    .result-box {
      margin-top: 10px;
      padding: 10px;
      background-color: var(--background-color);
      border: 1px solid var(--border-color);
      border-radius: 5px;
      text-align: center;
      display: none;
    }
    .conversion-history {
      margin-top: 15px;
      max-height: 200px;
      overflow-y: auto;
    }
    .conversion-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      border-bottom: 1px solid var(--border-color);
    }
    .conversion-item button {
      background: none;
      border: none;
      color: var(--btn-delete);
      cursor: pointer;
    }
    .progress-container {
      margin-top: 15px;
    }
    .progress-container input {
      width: 100%;
      margin-bottom: 10px;
    }
    .progress-bar {
      width: 100%;
      background-color: #ddd;
      border-radius: 5px;
      height: 20px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background-color: var(--primary-color);
      transition: width var(--transition-duration);
    }
    .progress-text {
      text-align: center;
      margin-top: 5px;
    }
    .main-content {
      flex: 1;
      display: flex;
    }
    .center-content {
      flex: 1;
      max-width: 800px;
    }
    .container {
      background-color: var(--card-bg);
      width: 100%;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 4px 10px var(--shadow-color);
      transition: background-color var(--transition-duration);
      position: relative;
    }
    .right-sidebar {
      width: 300px;
      margin-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .calendar-sidebar, .achievements-sidebar {
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px var(--shadow-color);
      transition: background-color var(--transition-duration);
      height: fit-content;
    }
    .calendar-sidebar h2, .achievements-sidebar h2 {
      margin-bottom: 15px;
      text-align: center;
      color: var(--text-color);
    }
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .calendar-nav {
      display: flex;
      gap: 10px;
    }
    .calendar-nav button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-color);
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    .calendar-day-header {
      text-align: center;
      font-weight: bold;
      padding: 5px;
    }
    .calendar-day {
      height: 80px;
      border: 1px solid var(--border-color);
      padding: 5px;
      overflow-y: auto;
    }
    .calendar-day.empty {
      background-color: var(--background-color);
      border: none;
    }
    .calendar-day.today {
      background-color: rgba(76, 175, 80, 0.2);
    }
    .calendar-day.has-tasks {
      background-color: rgba(0, 123, 255, 0.1);
      cursor: pointer;
    }
    .calendar-day-number {
      font-weight: bold;
      margin-bottom: 3px;
    }
    .calendar-task {
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 2px;
    }
    .task-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    .task-modal-content {
      background-color: var(--card-bg);
      padding: 20px;
      border-radius: 10px;
      width: 80%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .task-modal-close {
      float: right;
      cursor: pointer;
      font-size: 20px;
    }
    .achievement {
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
    }
    #toggle-theme {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 20px;
      color: var(--text-color);
    }
    .input-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .input-group input[type="text"],
    .input-group input[type="date"],
    .input-group select {
      flex: 1;
      min-width: 120px;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-size: 16px;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    .input-group button {
      padding: 12px 20px;
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .task-list {
      list-style: none;
    }
    .task-item {
      background-color: var(--card-bg);
      margin-bottom: 15px;
      padding: 15px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-shadow: 0 2px 5px var(--shadow-color);
      opacity: 0;
      transform: translateY(10px);
      transition: transform var(--transition-duration), opacity var(--transition-duration);
    }
    .task-item.show {
      opacity: 1;
      transform: translateY(0);
    }
    .task-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    .task-left {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }
    .toggle-subtasks-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-color);
    }
    .importance-badge,
    .urgency-badge {
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 3px;
      margin-left: 5px;
      color: #fff;
    }
    .importance-important { background-color: #dc3545; }
    .importance-notImportant { background-color: #6c757d; }
    .urgency-urgent { background-color: #ffc107; color: #000; }
    .urgency-notUrgent { background-color: #17a2b8; }
    .priority-span {
      font-size: 14px;
      margin-left: 5px;
      padding: 3px 7px;
      border-radius: 4px;
      color: #fff;
    }
    .priority-low { background-color: #6c757d; }
    .priority-medium { background-color: #17a2b8; }
    .priority-high { background-color: #dc3545; }
    .priority-boss { background-color: #b21feb; }
    .matrix-span {
      font-size: 13px;
      color: #777777;
      margin-left: 10px;
    }
    .due-date {
      font-size: 13px;
      color: #555555;
    }
    .task-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .task-right button {
      padding: 8px 12px;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
    }
    .task-right button.edit-btn {
      background-color: var(--btn-edit);
      color: #000;
    }
    .task-right button.subtask-btn {
      background-color: var(--primary-color);
      color: #fff;
    }
    .task-right button.delete-btn {
      background-color: var(--btn-delete);
      color: #fff;
    }
    .filters {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .filters button {
      padding: 10px 15px;
      background-color: var(--secondary-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .gamification, .stats {
      margin-top: 25px;
      padding: 15px;
      border-top: 1px solid var(--border-color);
    }
    .gamification h2 {
      margin-bottom: 10px;
      text-align: center;
    }
    .subtask-list {
      list-style: none;
      margin: 10px 0 0 20px;
      padding: 0;
    }
    .subtask-item {
      background-color: #fafafa;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #eee;
      border-radius: 5px;
      box-shadow: 0 1px 3px var(--shadow-color);
    }
    .add-achievement {
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .add-achievement input {
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      background-color: var(--card-bg);
      color: var(--text-color);
    }
    .add-achievement button {
      padding: 10px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color var(--transition-duration);
    }
    .add-achievement button:hover {
      background-color: var(--btn-hover);
    }
    .delete-achievement-btn {
      background: none;
      border: none;
      color: var(--btn-delete);
      cursor: pointer;
      font-size: 16px;
      padding: 5px;
    }
    .delete-achievement-btn:hover {
      color: #c82333;
    }
    </style>
</head>
<body>
    <header>
        <h1>LifeOS</h1>
        <div class="level">Уровень: <span id="level">1</span> | Опыт: <span id="xp">0</span>/100</div>
        <div class="xp-bar"><div class="xp-progress" id="xpProgress"></div></div>
        <button id="themeToggle" style="position:absolute;top:1rem;right:1rem;">🌙</button>
    </header>

    <div class="tabs">
        <div class="tab active" onclick="openTab(event, 'summary')">Обзор</div>
        <div class="tab" onclick="openTab(event, 'persona')">Персона</div>
        <div class="tab" onclick="openTab(event, 'needs')">Потребности</div>
        <div class="tab" onclick="openTab(event, 'health_detailed')">Здоровье</div>
        <div class="tab" onclick="openTab(event, 'social')">Социум</div>
        <div class="tab" onclick="openTab(event, 'work')">Работа</div>
        <div class="tab" onclick="openTab(event, 'items')">Вещи</div>
        <div class="tab" onclick="openTab(event, 'journal')">Журнал</div>
        <div class="tab" onclick="openTab(event, 'procedures_history')">Процедуры/История</div>
        <div class="tab" onclick="openTab(event, 'planner')">Планировщик</div>
    </div>

    <!-- Обзор -->
    <div id="summary" class="content active">
        <h2>Обзор Персонажа: <span id="characterName">Имярек</span></h2>
        
        <div class="summary-section" style="margin-bottom: 1rem; padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <h3>Ключевые Показатели</h3>
            <p><strong>Настроение:</strong> <span id="characterMood">Нейтральное</span></p>
            <div class="needs-summary">
                <p>Голод: <input type="range" id="hungerSummaryInput" min="0" max="100" value="70" style="width: 70%; vertical-align: middle;"> <span id="hungerSummaryValue">70</span>/100</p>
                <p>Отдых: <input type="range" id="restSummaryInput" min="0" max="100" value="80" style="width: 70%; vertical-align: middle;"> <span id="restSummaryValue">80</span>/100</p>
                <p>Развлечение: <input type="range" id="recreationSummaryInput" min="0" max="100" value="60" style="width: 70%; vertical-align: middle;"> <span id="recreationSummaryValue">60</span>/100</p>
            </div>
        </div>

        <div class="summary-section" style="margin-bottom: 1rem; padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <h3>Текущие Задачи</h3>
            <ul id="currentTasksSummary" style="list-style: none; padding-left: 0;">
                <li>Загрузка данных...</li>
            </ul>
        </div>

        <div class="summary-section" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <h3>Критические Оповещения</h3>
            <ul id="criticalAlertsSummary" style="list-style: none; padding-left: 0;">
                <li style="color:red;">Нет оповещений.</li>
            </ul>
        </div>

        <!-- Колесо жизненного баланса -->
        <div class="summary-section" style="margin-top: 1rem; padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <h3>Колесо жизненного баланса</h3>
            <div style="display: flex; gap: 1rem; align-items: flex-start;">
                <div style="flex: 1; max-width: 400px;">
                    <canvas id="lifeBalanceChart" width="400" height="400"></canvas>
                </div>
                <div style="flex: 1; min-width: 300px;">
                    <h4 style="margin-top: 0; color: #4A4A4A;">Настройка областей жизни:</h4>
                    <div id="lifeBalanceControls" style="display: grid; gap: 10px;">
                        <!-- Контролы будут добавлены через JavaScript -->
                    </div>
                    <div style="margin-top: 15px;">
                        <button onclick="resetLifeBalance()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-right: 10px;">Сбросить</button>
                        <button onclick="saveLifeBalance()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Сохранить</button>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-size: 0.9em; color: #495057;">
                        <strong>Средний балл:</strong> <span id="averageScore">0</span>/10<br>
                        <strong>Статус:</strong> <span id="balanceStatus">Требует внимания</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Персона -->
    <div id="persona" class="content">
        <h2>Персона: <input type="text" id="personaNameInput" placeholder="Имя персонажа" style="width: 200px;"> <button onclick="window.savePersonaData()">Сохранить Персону</button></h2>
        <div class="persona-section" style="display: flex; gap: 2rem;">
            <div class="persona-avatar" style="width: 150px; height: 150px; background: #4A4A4A; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #888; border: 1px solid #2A2A2A;">
                Аватар
                 <input type="file" id="avatarUpload" accept="image/*" style="display:none;">
                 <button onclick="document.getElementById('avatarUpload').click();" style="font-size:0.8em; padding: 0.2em 0.4em; margin-top:5px;">Загрузить</button>
            </div>
            <div class="persona-info" style="flex: 1;">
                <p><strong>Возраст:</strong> <input type="number" id="personaAgeInput" placeholder="Возраст" style="width: 60px;" value="28"> лет</p>
                <p><strong>Предыстория:</strong></p>
                <textarea id="personaBackstoryInput" placeholder="Опишите предысторию" style="width: 95%; min-height: 60px;">Исследователь пустошей</textarea>
                <p style="margin-top:0.5rem;"><strong>Черты характера:</strong></p>
                <textarea id="personaTraitsInput" placeholder="Перечислите черты характера через запятую" style="width: 95%; min-height: 40px;">Трудолюбивый, Оптимист, Нервный</textarea>
                <p style="margin-top:0.5rem;"><strong>Навыки (формат: Навык: Уровень/Макс):</strong></p>
                <textarea id="personaSkillsInput" placeholder="Пример: Строительство: 8/20, Медицина: 5/20" style="width: 95%; min-height: 60px;">Строительство: 8/20
Медицина: 5/20
Стрельба: 12/20</textarea>
            </div>
        </div>
        <div class="persona-section" style="margin-top: 1rem;">
            <h3>Экипировка</h3>
            <textarea id="personaEquipmentInput" placeholder="Перечислите экипировку, каждый предмет с новой строки" style="width: 95%; min-height: 80px;">Одежда: Пыльник
Оружие: Лазерный пистолет</textarea>
        </div>
    </div>

    <!-- Потребности -->
    <div id="needs" class="content">
        <h2>Потребности</h2>
        <div class="needs-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Голод</h3>
                <progress id="needHunger" value="70" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="hungerStatus">Удовлетворен</span></p>
            </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Отдых</h3>
                <progress id="needRest" value="80" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="restStatus">Отдохнувший</span></p>
            </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Развлечение</h3>
                <progress id="needRecreation" value="60" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="recreationStatus">Нуждается в развлечениях</span></p>
            </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Красота</h3>
                <progress id="needBeauty" value="50" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="beautyStatus">Равнодушен</span></p>
            </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Комфорт</h3>
                <progress id="needComfort" value="75" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="comfortStatus">Комфортно</span></p>
            </div>
            <div class="need-item" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <h3>Пространство</h3>
                <progress id="needSpace" value="90" max="100" style="width: 100%;"></progress>
                <p>Состояние: <span id="spaceStatus">Просторно</span></p>
            </div>
        </div>
    </div>

    <!-- Здоровье (Детально) -->
    <div id="health_detailed" class="content">
        <h2>Здоровье: <span id="healthCharacterName">Имярек</span></h2>
        <div class="health-overview" style="margin-bottom: 1rem; padding: 1rem; background: #e9ecef; border-radius: 8px;">
            <p><strong>Общее состояние:</strong> <span id="generalHealthStatus" style="color: green;">В порядке</span></p>
            <p><strong>Травмы:</strong> <span id="injuriesCount">0</span></p>
            <p><strong>Болезни:</strong> <span id="illnessesCount">0</span></p>
            <button onclick="window.openHealthLogModal()" style="margin-top: 0.5rem;">Добавить запись о здоровье</button>
        </div>

        <!-- Добавляем контейнер для RPG статов здоровья -->
        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>Характеристики здоровья</h3>
            <button onclick="window.openAddHealthStatModal()" style="margin-bottom: 1rem;">Добавить характеристику</button>
            <div id="health-stats-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <!-- Характеристики будут загружены из script.js (renderHealthStats) -->
            </div>
        </div>

        <!-- Добавляем контейнер для записей журнала здоровья -->
        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>Журнал здоровья</h3>
            <div id="healthList" style="display: flex; flex-direction: column; gap: 0.5rem;">
                <!-- Записи будут загружены из script.js (renderHealth) -->
            </div>
        </div>

        <div class="health-section" style="margin-bottom: 1rem;">
            <h3>Части Тела</h3>
            <ul id="bodyPartsList" style="list-style: none; padding-left: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Голова: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Туловище: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Левая рука: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Правая рука: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Левая нога: <span style="color: green;">100%</span></li>
                <li style="background: #f8f9fa; padding: 0.5rem; border-radius: 4px;">Правая нога: <span style="color: green;">100%</span></li>
            </ul>
        </div>

        <div class="health-section">
            <h3>Операции и Медицинские Процедуры</h3>
            <button onclick="window.openScheduleOperationModal()" style="margin-bottom: 0.5rem;">Запланировать операцию</button>
            <ul id="medicalOperationsList" style="list-style: none; padding-left: 0;">
                <li>Нет запланированных операций.</li>
            </ul>
        </div>
    </div>

    <!-- Социум -->
    <div id="social" class="content">
        <h2>Социум</h2>
        <div class="social-filters" style="margin-bottom: 1rem;">
            <button onclick="window.filterSocial('all')">Все</button>
            <button onclick="window.filterSocial('friends')">Друзья</button>
            <button onclick="window.filterSocial('family')">Семья</button>
            <button onclick="window.filterSocial('colleagues')">Коллеги</button>
            <button onclick="window.filterSocial('enemies')">Враги</button>
        </div>
        <div id="socialListContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <!-- Пример записи -->
            <div class="social-entry" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <p><strong>Имя:</strong> Елена <span style="color: blue;">(Друг)</span></p>
                <p><strong>Отношение:</strong> +75</p>
                <p><strong>Последний контакт:</strong> 2 дня назад</p>
                <button onclick="window.interactSocial('Elena')">Взаимодействовать</button>
            </div>
            <div class="social-entry" style="padding: 1rem; background: #e9ecef; border-radius: 8px;">
                <p><strong>Имя:</strong> Виктор <span style="color: red;">(Враг)</span></p>
                <p><strong>Отношение:</strong> -50</p>
                <p><strong>Последний контакт:</strong> 1 неделя назад</p>
                <button onclick="window.interactSocial('Viktor')">Взаимодействовать</button>
            </div>
        </div>
    </div>

    <!-- Работа -->
    <div id="work" class="content">
        <h2>Работа</h2>
        <div class="work-tabs" style="margin-bottom: 1rem; border-bottom: 1px solid #ccc; padding-bottom: 0.5rem;">
            <button onclick="window.openWorkSubTab(event, 'work_tasks')" class="work-tab-button active">Задачи</button>
            <button onclick="window.openWorkSubTab(event, 'work_schedule')" class="work-tab-button">Расписание</button>
            <button onclick="window.openWorkSubTab(event, 'work_priorities')" class="work-tab-button">Приоритеты</button>
        </div>

        <div id="work_tasks" class="work-sub-content active">
            <h3>Задачи</h3>
            <button onclick="window.openAddTaskModal()">Добавить задачу</button>
            <ul id="taskList" style="list-style: none; padding-left: 0;">
                <li style="padding: 0.5rem; background: #e9ecef; border-radius: 4px; margin-bottom: 0.5rem;">Построить стену (Приоритет: 1) <button onclick="window.setTaskPriority('wall', 2)">↑</button> <button onclick="window.setTaskPriority('wall', 0)">↓</button></li>
                <li style="padding: 0.5rem; background: #e9ecef; border-radius: 4px; margin-bottom: 0.5rem;">Исследовать технологию X (Приоритет: 2) <button onclick="window.setTaskPriority('research', 3)">↑</button> <button onclick="window.setTaskPriority('research', 1)">↓</button></li>
            </ul>
        </div>

        <div id="work_schedule" class="work-sub-content">
            <h3>Расписание Дня</h3>
            <div id="dailyScheduleContainer" style="display: grid; grid-template-columns: repeat(24, 1fr); gap: 2px; background: #f8f9fa; border: 1px solid #dee2e6; padding: 5px; height: 100px;">
                <!-- Часы дня будут здесь, например, div для каждого часа -->
                <script>
                    const scheduleContainer = document.getElementById('dailyScheduleContainer');
                    if (scheduleContainer) {
                        for(let i=0; i<24; i++){
                            let hourBlock = document.createElement('div');
                            hourBlock.style.border = '1px solid #ccc';
                            hourBlock.style.background = '#fff';
                            hourBlock.title = i + ':00 - ' + (i+1) + ':00 - Свободно';
                            hourBlock.textContent = i.toString().padStart(2, '0');
                            hourBlock.style.fontSize = '10px';
                            hourBlock.style.textAlign = 'center';
                            hourBlock.style.cursor = 'pointer';
                            hourBlock.onclick = () => alert('Назначить задачу на ' + i + ':00');
                            scheduleContainer.appendChild(hourBlock);
                        }
                        // Пример назначения
                        if(scheduleContainer.children[8]) scheduleContainer.children[8].style.background = 'lightblue'; // Работа
                        if(scheduleContainer.children[9]) scheduleContainer.children[9].style.background = 'lightblue';
                        if(scheduleContainer.children[12]) scheduleContainer.children[12].style.background = 'lightgreen'; // Отдых
                        if(scheduleContainer.children[22]) scheduleContainer.children[22].style.background = 'darkgrey'; // Сон
                        if(scheduleContainer.children[23]) scheduleContainer.children[23].style.background = 'darkgrey';
                    }
                </script>
            </div>
        </div>

        <div id="work_priorities" class="work-sub-content">
            <h3>Приоритеты Работ</h3>
            <ul style="list-style: none; padding-left: 0;">
                <li>Пожаротушение: <input type="number" value="1" min="0" max="4" style="width: 50px;"></li>
                <li>Пациент: <input type="number" value="1" min="0" max="4" style="width: 50px;"></li>
                <li>Доктор: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>Надзиратель: <input type="number" value="3" min="0" max="4" style="width: 50px;"></li>
                <li>Готовка: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>Охота: <input type="number" value="3" min="0" max="4" style="width: 50px;"></li>
                <li>Строительство: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>Ремонт: <input type="number" value="2" min="0" max="4" style="width: 50px;"></li>
                <li>Переноска: <input type="number" value="4" min="0" max="4" style="width: 50px;"></li>
            </ul>
        </div>
    </div>

    <!-- Вещи (бывший Инвентарь) -->
    <div id="items" class="content">
      <h2>Вещи <button id="add-item-btn">+ Добавить предмет</button> <button id="save-inventory-btn">Сохранить инвентарь</button></h2>
      <div>
          <button class="category-btn active" data-category="all">Все</button>
          <button class="category-btn" data-category="weapons">Оружие</button>
          <button class="category-btn" data-category="clothing">Одежда</button>
          <button class="category-btn" data-category="resources">Ресурсы</button>
          <button class="category-btn" data-category="medications">Медикаменты</button>
      </div>
      <div id="inventory-list">
          <!-- Предметы будут отображаться здесь -->
      </div>
      <p>Перетащите предмет между ячейками. Правый клик для опций.</p>
      
      <!-- Всплывающее окно для добавления предмета -->
      <div id="add-item-modal" style="display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: #fff; padding: 20px; border: 1px solid #ccc; z-index: 1000;">
          <h3>Добавить предмет</h3>
          <label>Название: <input type="text" id="item-name"></label><br>
          <label>Категория: 
              <select id="item-category">
                  <option value="weapons">Оружие</option>
                  <option value="clothing">Одежда</option>
                  <option value="resources">Ресурсы</option>
                  <option value="medications">Медикаменты</option>
              </select>
          </label><br>
          <label>Количество: <input type="number" id="item-quantity" min="1" value="1"></label><br>
          <label>Описание: <textarea id="item-description"></textarea></label><br>
          <button id="save-item-btn">Сохранить</button>
          <button id="cancel-item-btn">Отмена</button>
      </div>
      <div id="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999;"></div>
        <div class="inventory-grid" id="inventoryGridContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; padding: 10px; background: #2A2A2A; border-radius: 4px; min-height: 200px; border: 1px solid #4A4A4A;">
            <!-- Ячейки инвентаря будут генерироваться JavaScript -->
        </div>
        <div id="itemContextMenu" class="context-menu" style="display:none; position:absolute; background:#383838; border:1px solid #5A5A5A; border-radius:3px; padding:5px; z-index:1000;">
            <button onclick="window.deleteContextItem()">Удалить</button>
            <button onclick="window.editContextItemName()">Переименовать</button>
        </div>
        <div style="margin-top:1rem;text-align:center;color:#A89F8D;">Перетащите предмет между ячейками. Правый клик для опций.</div>
    </div>

    <!-- Журнал -->
    <div id="journal" class="content">
        <h2>Журнал Событий</h2>
        <div class="journal-filters" style="margin-bottom: 1rem;">
            <label for="journalDateFilter">Дата:</label>
            <input type="date" id="journalDateFilter" onchange="filterJournalEvents()">
            <label for="journalTypeFilter">Тип:</label>
            <select id="journalTypeFilter" onchange="filterJournalEvents()">
                <option value="all">Все</option>
                <option value="combat">Бой</option>
                <option value="social">Социальное</option>
                <option value="work">Работа</option>
                <option value="health">Здоровье</option>
                <option value="misc">Разное</option>
            </select>
        </div>
        <ul id="journalEntryList" style="list-style: none; padding-left: 0; max-height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 0.5rem; border-radius: 4px; background: #f8f9fa;">
            <!-- Пример записи -->
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>08:15:</strong> Атака рейдеров! <span style="color: red;">[Бой]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>10:30:</strong> Елена рассказала анекдот. (+5 Настроение) <span style="color: blue;">[Социальное]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>14:00:</strong> Завершена постройка стены. <span style="color: green;">[Работа]</span></li>
            <li style="padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>16:20:</strong> Имярек получил ушиб левой ноги. <span style="color: orange;">[Здоровье]</span></li>
        </ul>
    </div>

    <!-- Процедуры/История -->
    <div id="procedures_history" class="content">
        <h2>Процедуры и История Болезней</h2>
        <div class="history-filters" style="margin-bottom: 1rem;">
            <button onclick="window.filterHistory('all')">Вся история</button>
            <button onclick="window.filterHistory('operations')">Операции</button>
            <button onclick="window.filterHistory('treatments')">Лечение</button>
            <button onclick="window.filterHistory('illnesses')">Болезни</button>
            <button onclick="window.filterHistory('injuries')">Травмы</button>
        </div>
        <ul id="medicalHistoryList" style="list-style: none; padding-left: 0; max-height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 0.5rem; border-radius: 4px; background: #f8f9fa;">
            <!-- Пример записи -->
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>Дата: 2025-05-10</strong> - Операция: Удаление аппендикса. Статус: Успешно. <span style="color: purple;">[Операция]</span></li>
            <li style="border-bottom: 1px dashed #ddd; padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>Дата: 2025-04-22</strong> - Болезнь: Грипп. Лечение: Постельный режим, медикаменты. Статус: Выздоровел. <span style="color: orange;">[Болезнь]</span></li>
            <li style="padding-bottom: 0.5rem; margin-bottom: 0.5rem;"><strong>Дата: 2025-03-15</strong> - Травма: Перелом левой руки. Лечение: Гипс. Статус: Зажило. <span style="color: red;">[Травма]</span></li>
        </ul>
    </div>

    <!-- Планировщик -->
    <div id="planner" class="content">
      <div class="planner-root">
        <!-- Банк хранения виртуальной валюты -->
        <div class="planner-currency-sidebar">
          <h2>Банк хранения виртуальной валюты</h2>
          <div class="planner-converter-container">
            <div style="width:50px;height:50px;margin:0 auto 10px auto;background:#eee;border-radius:5px;text-align:center;line-height:50px;font-size:2em;color:#bbb;">₽</div>
            <input type="number" id="virtual-currency-input" placeholder="Введите сумму" min="0" class="planner-input">
            <button id="convert-currency-btn" class="planner-btn planner-btn-primary">Конвертировать (10:1)</button>
            <div id="currency-result" class="planner-result-box"></div>
          </div>
          <div class="planner-conversion-history">
            <h3>История конвертаций</h3>
            <div id="conversion-list"></div>
            <button id="clear-history" class="planner-btn planner-btn-secondary" style="margin-top: 10px; width: 100%;">Очистить историю</button>
          </div>
          <div class="planner-progress-container">
            <input type="number" id="savings-goal" placeholder="Установить цель (в рублях)" min="1" class="planner-input">
            <div class="planner-progress-bar">
              <div class="planner-progress-fill" id="progress-fill" style="width: 0%;"></div>
            </div>
            <p class="planner-progress-text" id="progress-text">0% (0 / 0 руб.)</p>
          </div>
        </div>
        <!-- Основное содержимое -->
        <div class="planner-main-content">
          <div class="planner-center-content">
            <div class="planner-container">
              <button id="toggle-theme" aria-label="Переключить тему" class="planner-btn planner-btn-theme"><i class="fas fa-moon"></i></button>
              <h1>Список дел</h1>
              <div class="planner-input-group">
                <input type="text" id="new-task" placeholder="Название задачи..." aria-label="Название задачи" class="planner-input">
                <select id="importance" aria-label="Важность" class="planner-select">
                  <option value="important" selected>Важно</option>
                  <option value="notImportant">Не важно</option>
                </select>
                <select id="urgency" aria-label="Срочность" class="planner-select">
                  <option value="urgent" selected>Срочно</option>
                  <option value="notUrgent">Не срочно</option>
                </select>
                <select id="priority" aria-label="Приоритет" class="planner-select">
                  <option value="low">Низкий</option>
                  <option value="medium" selected>Средний</option>
                  <option value="high">Высокий</option>
                  <option value="boss">Босс</option>
                </select>
                <input type="date" id="due-date" title="Дедлайн (необязательно)" aria-label="Дата дедлайна" class="planner-input">
                <button id="add-task" aria-label="Добавить задачу" class="planner-btn planner-btn-primary">Добавить</button>
              </div>
              <ul id="task-list" class="planner-task-list"></ul>
              <div class="planner-filters">
                <button id="show-all" aria-label="Показать все задачи" class="planner-btn planner-btn-secondary">Показать все</button>
                <button id="show-active" aria-label="Показать активные задачи" class="planner-btn planner-btn-blue">Активные</button>
                <button id="show-completed" aria-label="Показать выполненные задачи" class="planner-btn planner-btn-green">Выполненные</button>
              </div>
              <div class="planner-gamification">
                <h2>Геймификация</h2>
                <p>Уровень: <span id="level">1</span></p>
                <p>Опыт (XP): <span id="xp">0</span></p>
                <p>Виртуальная валюта: <span id="currency">0</span></p>
                <p>Здоровье (HP): <span id="hp">100</span></p>
              </div>
              <div class="planner-stats">
                <p>Всего задач (только основные): <span id="total-tasks">0</span></p>
                <p>Выполнено (основных): <span id="completed-tasks">0</span></p>
                <p>Активных (основных): <span id="active-tasks">0</span></p>
              </div>
            </div>
          </div>
          <!-- Календарь и достижения -->
          <div class="planner-right-sidebar">
            <div class="planner-calendar-sidebar">
              <h2>Календарь задач</h2>
              <div class="planner-calendar-header">
                <div class="planner-calendar-nav">
                  <button id="prev-month" class="planner-btn planner-btn-secondary"><i class="fas fa-chevron-left"></i></button>
                  <button id="next-month" class="planner-btn planner-btn-secondary"><i class="fas fa-chevron-right"></i></button>
                </div>
                <h3 id="current-month-year">Май 2023</h3>
              </div>
              <div class="planner-calendar-grid" id="calendar-days-header">
                <div class="planner-calendar-day-header">Пн</div>
                <div class="planner-calendar-day-header">Вт</div>
                <div class="planner-calendar-day-header">Ср</div>
                <div class="planner-calendar-day-header">Чт</div>
                <div class="planner-calendar-day-header">Пт</div>
                <div class="planner-calendar-day-header">Сб</div>
                <div class="planner-calendar-day-header">Вс</div>
              </div>
              <div class="planner-calendar-grid" id="calendar-days"></div>
            </div>
            <div class="planner-achievements-sidebar">
              <h2>Достижения</h2>
              <div class="planner-add-achievement">
                <input type="text" id="achievement-name" placeholder="Название достижения" aria-label="Название достижения" class="planner-input">
                <input type="text" id="achievement-desc" placeholder="Описание" aria-label="Описание достижения" class="planner-input">
                <button id="add-achievement-btn" class="planner-btn planner-btn-primary">Добавить</button>
              </div>
              <div id="achievements-list"></div>
            </div>
          </div>
        </div>
        <!-- Модальное окно -->
        <div class="planner-task-modal" id="task-modal">
          <div class="planner-task-modal-content">
            <span class="planner-task-modal-close">×</span>
            <h3 id="modal-date">Задачи на 1 мая 2023</h3>
            <ul id="modal-task-list"></ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Модальное окно для журнала здоровья -->
    <div class="modal" id="healthLogModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:100;justify-content:center;align-items:center;">
        <div class="modal-content" style="background:#ffffff;padding:20px;border-radius:10px;max-width:500px;width:100%;position:relative;">
            <span class="close-button" onclick="window.closeHealthLogModal()" style="position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;">&times;</span>
            <h3 style="margin-top:0;">Добавить запись о здоровье</h3>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="sleep">Сон (часов):</label>
                <input type="number" id="sleep" min="0" max="24" step="0.5" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="water">Вода (литров):</label>
                <input type="number" id="water" min="0" max="10" step="0.1" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="healthNote">Заметка:</label>
                <textarea id="healthNote" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;min-height:100px;"></textarea>
            </div>
            <button onclick="window.addHealthEntry()" style="background:#4CAF50;color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;width:100%;">Сохранить запись</button>
        </div>
    </div>

    <!-- Модальное окно для добавления/редактирования RPG характеристик здоровья -->
    <div class="modal" id="healthStatModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:100;justify-content:center;align-items:center;">
        <div class="modal-content" style="background:#ffffff;padding:20px;border-radius:10px;max-width:500px;width:100%;position:relative;">
            <span class="close-button" onclick="window.closeHealthStatModal()" style="position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;">&times;</span>
            <h3 id="healthStatModalTitle" style="margin-top:0;">Добавить характеристику здоровья</h3>
            <input type="hidden" id="editingStatIndex" value="-1">
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statName">Название:</label>
                <input type="text" id="statName" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statValue">Значение:</label>
                <input type="text" id="statValue" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statUnit">Единица измерения:</label>
                <input type="text" id="statUnit" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statCategory">Категория:</label>
                <select id="statCategory" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;">
                    <option value="Физическое состояние">Физическое состояние</option>
                    <option value="Жизненные показатели">Жизненные показатели</option>
                    <option value="Психическое состояние">Психическое состояние</option>
                    <option value="Медицинские данные">Медицинские данные</option>
                    <option value="Травмы/Болезни">Травмы/Болезни</option>
                    <option value="Другое">Другое</option>
                </select>
            </div>
            <div class="form-group" style="margin-bottom:15px;">
                <label for="statComment">Комментарий:</label>
                <textarea id="statComment" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;min-height:60px;"></textarea>
            </div>
            <button onclick="window.saveHealthStat()" style="background:#4CAF50;color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;width:100%;">Сохранить характеристику</button>
        </div>
    </div>

    <!-- Отношения -->
    <div id="relationships" class="content">
        <h2>Отношения</h2>
        <div>
            <input type="text" id="relationshipName" placeholder="Имя">
            <input type="date" id="nextContact">
            <button onclick="window.addRelationship()">Добавить</button>
        </div>
        <div id="relationshipList"></div>
    </div>

    <!-- Навыки -->
    <div id="skills" class="content">
        <h2>Навыки</h2>
        <div>
            <input type="text" id="skillName" placeholder="Навык">
            <select id="skillCategory">
                <option value="Программирование">Программирование</option>
                <option value="Дизайн">Дизайн</option>
                <option value="VR/AR">VR/AR</option>
            </select>
            <button onclick="window.addSkill()">Добавить</button>
        </div>
        <div id="skillList"></div>
    </div>

    <!-- Инвентарь -->
    <div id="inventory" class="content">
        <h2>Инвентарь</h2>
        <div id="inventoryGrid" style="display:grid;grid-template-columns:repeat(6,60px);gap:12px;max-width:400px;margin:2rem auto 0 auto;"></div>
        <div style="margin-top:2rem;text-align:center;color:#888;">Перетащите предмет между ячейками</div>
    </div>

    <script src="script.js"></script>
    <script src="planner.js"></script>
    
    <!-- Скрипт для колеса жизненного баланса -->
    <script>
        let lifeBalanceChart;
        
        // Области жизни по умолчанию
        const defaultLifeAreas = [
            { name: 'Здоровье', value: 7, color: '#FF6384' },
            { name: 'Карьера', value: 6, color: '#36A2EB' },
            { name: 'Финансы', value: 5, color: '#FFCE56' },
            { name: 'Отношения', value: 8, color: '#4BC0C0' },
            { name: 'Семья', value: 7, color: '#9966FF' },
            { name: 'Друзья', value: 6, color: '#FF9F40' },
            { name: 'Хобби', value: 4, color: '#FF6384' },
            { name: 'Развитие', value: 5, color: '#C9CBCF' },
            { name: 'Духовность', value: 3, color: '#4BC0C0' },
            { name: 'Отдых', value: 6, color: '#36A2EB' }
        ];
        
        // Загрузка данных из localStorage
        function loadLifeBalanceData() {
            const saved = localStorage.getItem('lifeBalanceData');
            return saved ? JSON.parse(saved) : defaultLifeAreas;
        }
        
        // Сохранение данных в localStorage
        function saveLifeBalance() {
            const areas = [];
            const controls = document.querySelectorAll('#lifeBalanceControls .life-area-control');
            controls.forEach((control, index) => {
                const nameInput = control.querySelector('.area-name');
                const valueInput = control.querySelector('.area-value');
                areas.push({
                    name: nameInput.value,
                    value: parseInt(valueInput.value),
                    color: defaultLifeAreas[index % defaultLifeAreas.length].color
                });
            });
            localStorage.setItem('lifeBalanceData', JSON.stringify(areas));
            updateChart(areas);
            updateStats(areas);
            alert('Данные колеса жизненного баланса сохранены!');
        }
        
        // Сброс к значениям по умолчанию
        function resetLifeBalance() {
            if (confirm('Вы уверены, что хотите сбросить все значения к настройкам по умолчанию?')) {
                localStorage.removeItem('lifeBalanceData');
                initLifeBalanceChart();
            }
        }
        
        // Создание контролов для редактирования
        function createControls(areas) {
            const container = document.getElementById('lifeBalanceControls');
            container.innerHTML = '';
            
            areas.forEach((area, index) => {
                const controlDiv = document.createElement('div');
                controlDiv.className = 'life-area-control';
                controlDiv.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    padding: 5px;
                    background: white;
                    border-radius: 4px;
                    border: 1px solid #ddd;
                `;
                
                controlDiv.innerHTML = `
                    <div style="width: 20px; height: 20px; background: ${area.color}; border-radius: 50%; flex-shrink: 0;"></div>
                    <input type="text" class="area-name" value="${area.name}" 
                           style="flex: 1; border: none; background: transparent; font-size: 0.9em; outline: none;">
                    <input type="range" class="area-value" min="0" max="10" value="${area.value}" 
                           style="width: 80px;" 
                           oninput="updateChartRealtime()">
                    <span class="area-value-display" style="min-width: 20px; font-weight: bold; color: #495057;">${area.value}</span>
                `;
                
                container.appendChild(controlDiv);
                
                // Обновление отображения значения при изменении слайдера
                const slider = controlDiv.querySelector('.area-value');
                const display = controlDiv.querySelector('.area-value-display');
                slider.addEventListener('input', function() {
                    display.textContent = this.value;
                });
            });
        }
        
        // Обновление диаграммы в реальном времени
        function updateChartRealtime() {
            const areas = [];
            const controls = document.querySelectorAll('#lifeBalanceControls .life-area-control');
            controls.forEach((control, index) => {
                const nameInput = control.querySelector('.area-name');
                const valueInput = control.querySelector('.area-value');
                areas.push({
                    name: nameInput.value,
                    value: parseInt(valueInput.value),
                    color: defaultLifeAreas[index % defaultLifeAreas.length].color
                });
            });
            updateChart(areas);
            updateStats(areas);
        }
        
        // Обновление диаграммы
        function updateChart(areas) {
            if (lifeBalanceChart) {
                lifeBalanceChart.data.labels = areas.map(area => area.name);
                lifeBalanceChart.data.datasets[0].data = areas.map(area => area.value);
                lifeBalanceChart.data.datasets[0].backgroundColor = areas.map(area => area.color + '40');
                lifeBalanceChart.data.datasets[0].borderColor = areas.map(area => area.color);
                lifeBalanceChart.update('none');
            }
        }
        
        // Обновление статистики
        function updateStats(areas) {
            const average = areas.reduce((sum, area) => sum + area.value, 0) / areas.length;
            const avgElement = document.getElementById('averageScore');
            const statusElement = document.getElementById('balanceStatus');
            
            if (avgElement) {
                avgElement.textContent = average.toFixed(1);
            }
            
            if (statusElement) {
                let status = 'Требует внимания';
                let color = '#dc3545';
                
                if (average >= 8) {
                    status = 'Отличный баланс!';
                    color = '#28a745';
                } else if (average >= 6) {
                    status = 'Хороший баланс';
                    color = '#ffc107';
                } else if (average >= 4) {
                    status = 'Средний баланс';
                    color = '#fd7e14';
                }
                
                statusElement.textContent = status;
                statusElement.style.color = color;
                statusElement.style.fontWeight = 'bold';
            }
        }
        
        // Инициализация диаграммы
        function initLifeBalanceChart() {
            const areas = loadLifeBalanceData();
            createControls(areas);
            
            const ctx = document.getElementById('lifeBalanceChart');
            if (!ctx) return;
            
            // Уничтожаем существующую диаграмму если есть
            if (lifeBalanceChart) {
                lifeBalanceChart.destroy();
            }
            
            lifeBalanceChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: areas.map(area => area.name),
                    datasets: [{
                        label: 'Уровень удовлетворенности',
                        data: areas.map(area => area.value),
                        backgroundColor: areas.map(area => area.color + '40'),
                        borderColor: areas.map(area => area.color),
                        borderWidth: 2,
                        pointBackgroundColor: areas.map(area => area.color),
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.r + '/10';
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: 10,
                            stepSize: 1,
                            backgroundColor: 'rgba(255, 255, 255, 0.1)',
                            grid: {
                                color: '#4A4A4A',
                                lineWidth: 1
                            },
                            angleLines: {
                                color: '#4A4A4A',
                                lineWidth: 1
                            },
                            pointLabels: {
                                color: '#2E2E2E',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                }
                            },
                            ticks: {
                                color: '#4A4A4A',
                                font: {
                                    size: 10
                                },
                                stepSize: 2,
                                showLabelBackdrop: false
                            }
                        }
                    },
                    interaction: {
                        intersect: false
                    },
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart'
                    }
                }
            });
            
            updateStats(areas);
        }
        
        // Глобальные функции для доступа из HTML
        window.saveLifeBalance = saveLifeBalance;
        window.resetLifeBalance = resetLifeBalance;
        window.updateChartRealtime = updateChartRealtime;
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Небольшая задержка для обеспечения полной загрузки Chart.js
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    initLifeBalanceChart();
                } else {
                    console.error('Chart.js не загружен');
                }
            }, 100);
        });
    </script>
      <!-- ================= ЧАТ-БОТ ================= -->
  <div id="chat-container" style="position: fixed; bottom: 20px; right: 20px; width: 300px;
                                    background: #fff; border: 1px solid #ccc; border-radius: 8px;
                                    box-shadow: 0 2px 10px rgba(0,0,0,.1); z-index: 999;">
    <div id="chat-header" style="padding: 10px; border-bottom: 1px solid #eee;
                                 font-weight: bold; cursor: pointer;
                                 display: flex; justify-content: space-between; align-items: center;"
         onclick="toggleChatCollapse()">
      <span>Помощник</span>
      <span id="chat-toggle-icon" style="font-size: 14px; user-select: none;">▼</span>
    </div>
    <div id="chat-messages" style="height: 200px; overflow-y: auto; padding: 10px; font-size: 14px;">
      <!-- сюда будут падать сообщения -->
    </div>
    <div id="chat-input" style="display: flex; border-top: 1px solid #eee;">
      <input id="chat-text" type="text" placeholder="Ваш вопрос…"
             style="flex:1; border:none; padding:8px; outline:none;">
      <button id="chat-send" style="border:none; padding:0 12px; cursor:pointer;">▶</button>
    </div>
  </div>
  <!-- =========================================== -->

  <script>
    // Функция для сворачивания/разворачивания чата
    let isChatCollapsed = false;
    
    function toggleChatCollapse() {
      const chatMessages = document.getElementById("chat-messages");
      const chatInput = document.getElementById("chat-input");
      const toggleIcon = document.getElementById("chat-toggle-icon");
      
      if (isChatCollapsed) {
        // Разворачиваем
        chatMessages.style.display = "block";
        chatInput.style.display = "flex";
        toggleIcon.textContent = "▼";
        isChatCollapsed = false;
      } else {
        // Сворачиваем
        chatMessages.style.display = "none";
        chatInput.style.display = "none";
        toggleIcon.textContent = "▲";
        isChatCollapsed = true;
      }
    }
    
    // 1) Функция общения с LM Studio через OpenAI-совместимый API
    async function queryLMStudio(prompt, contextTasks) {
      const messages = [
        {
          role: "system",
          content:
            "Ты — помошник. " +
            "Вот текущий список задач:\n" +
            contextTasks.map((t, i) => `${i + 1}. ${t.text}`).join("\n")
        },
        { role: "user", content: prompt }
      ];

      const res = await fetch("http://127.0.0.1:1234/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer lm-studio"  // если вы меняли API Key, впишите свой
        },
        body: JSON.stringify({
          model: "hermes-3-llama-3.2-3b",
          messages: messages
        })
      });

      if (!res.ok) {
        const err = await res.text();
        throw new Error(`LM Studio API error ${res.status}: ${err}`);
      }
      const json = await res.json();
      return json.choices[0].message.content;
    }

    // 2) Добавляет сообщение в окно чата
    function appendMessage(text, fromUser = true) {
      const container = document.getElementById("chat-messages");
      const div = document.createElement("div");
      div.style.margin = "6px 0";
      div.style.textAlign = fromUser ? "right" : "left";
      div.textContent = text;
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
    }

    // 3) Загружает список задач из localStorage
    function loadTasks() {
      return JSON.parse(localStorage.getItem("tasks") || "[]");
    }

    // 4) Обработчик клика по кнопке отправки
    document.getElementById("chat-send").addEventListener("click", async () => {
      const input = document.getElementById("chat-text");
      const question = input.value.trim();
      if (!question) return;
      appendMessage(question, true);
      input.value = "";
      try {
        const tasks = loadTasks();
        const answer = await queryLMStudio(question, tasks);
        appendMessage(answer, false);
      } catch (e) {
        appendMessage("Ошибка: " + e.message, false);
      }
    });

    // 5) Отправка по Enter
    document.getElementById("chat-text").addEventListener("keypress", e => {
      if (e.key === "Enter") {
        document.getElementById("chat-send").click();
        e.preventDefault();
      }
    });
  </script>

</html>